{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./examples/graphql-example/Post/index.js","webpack:///./examples/graphql-example/Post/resolver.js","webpack:///./examples/graphql-example/Post/schema.js","webpack:///./examples/graphql-example/User/index.js","webpack:///./examples/graphql-example/User/resolver.js","webpack:///./examples/graphql-example/User/schema.js","webpack:///./examples/graphql-example/directives.js","webpack:///./examples/graphql-example/index.js","webpack:///./src/apolloServer/graphqlOptions.js","webpack:///./src/apolloServer/index.js","webpack:///./src/apolloServer/main.js","webpack:///./src/apolloServer/runHttpQuery.js","webpack:///./src/apolloServer/runQuery.js","webpack:///./src/graphql/graphQlHandler.js","webpack:///./src/graphql/graphQlSchema.js","webpack:///./src/http/defaultHandler.js","webpack:///./src/http/handler.js","webpack:///./src/http/openApi.js","webpack:///./src/http/path.js","webpack:///./src/http/request.js","webpack:///./src/http/response.js","webpack:///./src/http/router.js","webpack:///./src/main.js","webpack:///./src/middlewareHandler.js","webpack:///./src/objectFactories.js","webpack:///./src/registerRouters.js","webpack:///./src/sockets/socketHandler.js","webpack:///./src/sockets/socketListener.js","webpack:///./src/sockets/socketRouter.js","webpack:///./src/utils.js","webpack:///external \"apollo-cache-control\"","webpack:///external \"apollo-client-preset\"","webpack:///external \"apollo-link-http\"","webpack:///external \"apollo-server-module-graphiql\"","webpack:///external \"apollo-tracing\"","webpack:///external \"apollo-utilities\"","webpack:///external \"babel-polyfill\"","webpack:///external \"bluebird\"","webpack:///external \"body-parser\"","webpack:///external \"etag\"","webpack:///external \"eventemitter2\"","webpack:///external \"fs\"","webpack:///external \"graphql\"","webpack:///external \"graphql-extensions\"","webpack:///external \"graphql-subscriptions\"","webpack:///external \"graphql-tools\"","webpack:///external \"http\"","webpack:///external \"json-to-pretty-yaml\"","webpack:///external \"node-fetch\"","webpack:///external \"os\"","webpack:///external \"print-message\"","webpack:///external \"socket.io\"","webpack:///external \"subscriptions-transport-ws\"","webpack:///external \"superstruct\"","webpack:///external \"treeify\"","webpack:///external \"url\"","webpack:///external \"ws\""],"names":["PostSchema","app","createGraphQlSchema","postSchema","resolver","postResolver","query","mutation","subscription","Query","Post","obj","args","context","info","name","id","post","data","Subscription","pubsub","postAdded","subscribe","asyncIterator","Mutation","publish","input","schema","UserSchema","userSchema","userResolver","User","first_name","last_name","height","role","user","posts","createUser","root","deleteUser","directiveResolvers","SchemaDirectiveVisitor","defaultFieldResolver","auth","field","details","console","log","handleAuth","type","fields","getFields","fieldKeys","Object","keys","key","object","resolve","source","headers","jwt","Error","apply","match","directiveArgs","validateNewUser","prettyPrint","graphql","useGraphql","allowPartialRemoteSchema","useGraphiql","tracing","registerGraphQlSchemas","enum","options","listen","message","resolveGraphqlOptions","runQuery","LogFunction","LogMessage","LogStep","LogAction","runHttpQuery","HttpQueryError","graphqlExpress","graphiqlExpress","url","GraphiQL","arguments","length","graphqlHandler","req","res","method","body","then","gqlResponse","setHeader","Buffer","byteLength","toString","write","end","error","forEach","header","statusCode","Handler","parse","resolveGraphiQLString","graphiqlString","handlerArguments","request","isGetRequest","optionsObject","formatErrorFn","formatError","requestPayload","Allow","isBatch","Array","isArray","requests","map","requestParams","extensions","JSON","undefined","persistedQuery","stringify","errors","isQueryOperation","operationName","variables","assign","create","getPrototypeOf","params","rootValue","logFunction","validationRules","formatResponse","fieldResolver","debug","cacheControl","formatParams","e","Promise","reject","all","responses","isGraphQLError","operationAST","operation","GraphQLResponse","validation","execute","start","status","action","step","QueryOptions","Function","doRunQuery","printStackTrace","stack","format","formatter","err","newError","documentAST","debugDefault","push","TracingExtension","CacheControlExtension","extensionStack","GraphQLExtensionStack","_extensionStack","requestDidStart","qry","syntaxError","rules","specifiedRules","concat","validationErrors","executionDidStart","result","response","executionDidEnd","requestDidEnd","executionError","server","_useGraphql","_internal","PubSub","makeExecutableSchema","getIntrospectSchema","createHttpLink","HttpLink","fetch","introspectSchema","makeRemoteExecutableSchema","mergeSchemas","bodyParser","SubscriptionServer","SubscriptionClient","ws","getMainDefinition","split","os","print","_injected","_Instance","_version","GraphQLScalarType","GraphQLNonNull","GraphQLString","executableSchema","directives","_graphQlDirectives","enums","_graphQlEnums","schemas","_graphQlSchemas","finalGraphQlOptionsObject","logger","_graphQlRemoteEndpoints","_graphQlExecutableSchema","Directives","Types","Enums","resolvers","Enum","option","join","dir","includes","schemaProps","getObjProps","props","typeDefs","getIntrospectSchemaWithParams","ep","filter","item","visitSchemaDirectives","router","createRouter","middleware","json","graphiqlRoute","createPath","handler","endpointURL","graphqlRoute","subscriptionsEndpoint","get","registerRouters","events","emit","path","platform","hostname","arch","cpus","freemem","totalmem","toFixed","graphQlHandler","GraphQlSchemaCreator","_graphql","_pathData","mockSchema","chainLink","override","defaultErrorHandler","StructError","dataPassed","valueReceived","value","typeExpected","toUpperCase","createHandler","next","__proto__","urlUtil","splitRest","urlCombinationOptions","populateUrlOptions","handleNestedRoutersUtil","_routersObject","baseOfRequest","rest","combinedRoutersMids","finalRest","populateQueryUtil","populateParamsUtil","param","canSkipBecauseParams","_middleWares","midHandler","defaultHandler","currentRoute","middleWareArr","describe","incoming","i","searchIn","in","statusObject","outgoing","errHandler","routerErrorHandler","errorFromErrorHandlers","reduce","prev","curr","contactStruct","email","licenseStruct","serverStruct","description","infoStruct","title","version","termsOfService","contact","license","mainDescribeStruct","openapi","security","servers","mainDescribe","validJson","singlePathMetaData","tags","parameters","requestBody","summary","methodStruct","methodName","pathStruct","pathName","getNested","struct","kind","replace","substring","indexOf","types","addRequest","content","contentType","$ref","responseBuilder","responseObject","resp","pathDescribe","myRegexp","swaggerPath","bodyRequests","parametersRequests","injectedPathWithParams","parametersToInject","arrayToConcat","required","jsonWithParams","securitySchemes","schemasObject","sc","components","PathCreator","_PathReturn","parent","arr","http","IncomingMessage","prototype","ServerResponse","stringified","generatedEtag","RouterCreator","base","_RouterReturn","_routerData","put","del","subRouters","utils","factories","httpDependencies","CreateHandler","graphqlDependencies","GraphQlCreator","socketDependencies","SocketListenerCreator","SocketRouterCreator","socketMiddlewareHandler","socketHandler","superStructObject","superstruct","appDependencies","io","fs","treeify","EventEmitter","packgeJson","RegisterRouters","BlizAppParams","BlizApp","_options","_loggerEntity","sockets","_useSockets","useSockets","delimiter","_socketRoutersObject","_socketMiddlewares","_socketSubApps","defaultMaxAge","_useHttp","useSwagger","_describe","_subApps","_appData","_createHandler","bind","CreateNewObjOf","dependencies","AssignHandler","CreateObjectArray","CreateArray","CreateSwagger","PrettyPrint","EventsCreator","GetObjProps","Listen","BlizCreator","fn","timeout","throwError","socket","msg","cb","handlerPromise","promiseTimeout","promise","ms","setTimeout","clearTimeout","race","createServer","Cluster","populateObjectWithTreeUtil","once","setImmediate","asTree","Method","swagger","swaggerOptions","yaml","routersKeys","mainPathsObject","paths","fullPath","responseObjectsForSchema","fullObj","absoluteFilePath","writeFileSync","wildcard","populateSubAppsUtil","populateRoutersUtil","populateSocketRoutersUtil","routers","registerSocketRouters","registerRemoteGraphQlSchemas","endpoints","checkSubRouters","injectedIo","on","eventKeys","event","eventKey","chosenEvent","combinedMiddlewareArray","prefix","CreateSocketListener","pathData","routerData","methodUpperCase","dividedUrl","toLowerCase","slice","each","unshift","checkBaseUtil","remoteSchema","httpLink","uri","wsLink","reconnect","link","entity","objectToAddTo","keysOfEntity","routeValues","routeKey","route","assignedOption","innerRouterObj","list","mds","routes","subApps","subApp","_middlewares","innerSubApps","startStr","urlPart","splitUrl","routesObject","lastDefinedRoute","indexOfLastRoute","substr","urlArray","keyValue","urlToReturn","newBase","array","routersObject","splitArr","counter","toBeCounted","len","keyPath","lastKeyIndex"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./examples/graphql-example/index.js\");\n","import postSchema from './schema'\r\nimport postResolver from './resolver'\r\n\r\nexport default function PostSchema (app) {\r\n  return app\r\n  .createGraphQlSchema(postSchema)\r\n  .resolver(postResolver)\r\n  .query(`Post(id: Int!): Post`)\r\n  .mutation(`Post(input: newPost): Post`)\r\n  .subscription(`postAdded: Post`)\r\n}\r\n","const resolver = {\r\n  Query:{\r\n      Post(obj, args, context, info){\r\n          return {name:'asdsda', id:args.id}\r\n      }\r\n  },\r\n  Post:{\r\n      name(post, args, context, info){\r\n          return post.name\r\n      },\r\n      id(post, args, context, info){\r\n          return post.id\r\n      },\r\n      data(post, args, context, info){\r\n          return post.data\r\n      }\r\n  },\r\n    Subscription:(pubsub)=> ({\r\n        postAdded: {\r\n        subscribe:()=>{\r\n            return pubsub.asyncIterator('POST_ADDED')\r\n        }\r\n        }\r\n    }),\r\n  Mutation:(pubsub)=>({\r\n    Post(obj, args, context, info){\r\n        pubsub.publish('POST_ADDED', {postAdded: args.input});\r\n        return {...args.input}\r\n    }\r\n  })\r\n}\r\n\r\nexport default resolver\r\n","const schema = `\r\ntype Post{\r\n    name: String!\r\n    id: Int!\r\n    data: String\r\n}\r\ninput newPost{\r\n    name: String!\r\n    id: Int!\r\n    data: String\r\n}\r\n`\r\n\r\nexport default schema\r\n","import userSchema from './schema'\r\nimport userResolver from './resolver'\r\n\r\nexport default function UserSchema (app) {\r\n  return app.createGraphQlSchema(userSchema)\r\n  .resolver(userResolver)\r\n  .mutation(`\r\n      createUser(input: newUser @auth @validateNewUser @constraint(length: 3)): User\r\n      deleteUser(first_name: String! @match(name:\"yura\")): User\r\n  `)\r\n  .query(`User(id: Int! ): User`)\r\n}\r\n","const resolver = {\r\n  Query:{\r\n      User(obj, args, context, info){\r\n          return {first_name:'Yura', last_name:'Khomyakov', height: \"tall\", role: 'Admin'}\r\n      }\r\n  },\r\n  User:{\r\n      first_name(user, args, context, info){\r\n          return user.first_name\r\n      },\r\n      last_name(user, args, context, info){\r\n          return user.last_name\r\n      },\r\n      role(user){\r\n          return user.role\r\n      },\r\n      posts(user, args, context, info){\r\n          return [{name:'post', id:1, data:'data'}]\r\n      }\r\n  },\r\n  Mutation:(pubsub)=>({\r\n      createUser(root, { input }, context){\r\n          return input\r\n      },\r\n      deleteUser(root, args, context){\r\n          return {first_name: args.first_name, last_name: 'whatever'}\r\n      },\r\n  })\r\n}\r\n\r\nexport default resolver\r\n","const schema = `\r\ntype User{\r\n  first_name: String!\r\n  role: Role!\r\n  last_name: String!\r\n  height: Height\r\n  posts: [Post]\r\n}\r\ninput newUser{\r\n  first_name: String!\r\n  last_name: String!\r\n  height: String!\r\n}\r\n`\r\n\r\nexport default schema\r\n","const directiveResolvers = (SchemaDirectiveVisitor, defaultFieldResolver) => ({\r\n  auth: class extends SchemaDirectiveVisitor {\r\n    visitInputFieldDefinition (field, details) {\r\n      console.log(field)\r\n      this.handleAuth(field, details)\r\n    }     \r\n    visitFieldDefinition (field, details) {\r\n      this.handleAuth(field, details)\r\n    }\r\n    visitObject(type){\r\n      const fields = type.getFields()\r\n      const fieldKeys = Object.keys(fields)\r\n      for(let key of fieldKeys){\r\n        this.handleAuth(fields[key])\r\n      }\r\n    }\r\n    visitInputObject(type){\r\n      const fields = type.getFields()\r\n      const fieldKeys = Object.keys(fields)\r\n      for(let key of fieldKeys){\r\n        this.handleAuth(fields[key])\r\n      }\r\n    }\r\n    visitArgumentDefinition(field, object){\r\n      this.handleAuth(object.field)\r\n    }\r\n    handleAuth(field, details){\r\n      const { resolve = defaultFieldResolver } = field\r\n      field.resolve = async function (\r\n        source,\r\n        args,\r\n        context,\r\n        info\r\n      ) {\r\n        if(!context.headers.jwt){\r\n          throw new Error('Authorization Bearer required')\r\n        } else {\r\n          // decode jwt and put on context as user\r\n          return resolve.apply(this, args);\r\n        }\r\n      };\r\n    }\r\n  },\r\n  match:class extends SchemaDirectiveVisitor {\r\n    visitArgumentDefinition(field, object){\r\n      this.handleAuth(object.field, this.args)\r\n    }\r\n    handleAuth(field, directiveArgs){\r\n      const { resolve = defaultFieldResolver } = field\r\n      field.resolve = async function (\r\n        source,\r\n        args,\r\n        context,\r\n        info\r\n      ) {\r\n        if(args.first_name !== directiveArgs.name){\r\n          throw new Error('Invalid first_name')\r\n        } else {\r\n          return resolve(source, args, context, info)\r\n        }\r\n        \r\n      };\r\n    }\r\n  },\r\n  validateNewUser:class extends SchemaDirectiveVisitor {\r\n    visitArgumentDefinition(field, object){\r\n      this.handleAuth(object.field)\r\n    }\r\n    handleAuth(field, details){\r\n      const { resolve = defaultFieldResolver } = field\r\n      field.resolve = async function (\r\n        source,\r\n        args,\r\n        context,\r\n        info\r\n      ) {\r\n        if(args.first_name !== 'yura'){\r\n          throw new Error('Invalid first_name')\r\n        } else {\r\n          return resolve(source, args, context, info)\r\n        }\r\n        \r\n      };\r\n    }\r\n  },\r\n})\r\n\r\nexport default directiveResolvers","import Bliz, { SchemaDirectiveVisitor, defaultFieldResolver } from '../../src/main'\r\n\r\nimport PostSchema from './Post'\r\nimport UserSchema from './User'\r\nimport directiveResolvers from './directives'\r\nconst app = Bliz()\r\n\r\napp\r\n.prettyPrint()\r\n.graphql({useGraphql: true, allowPartialRemoteSchema: true, directiveResolvers: directiveResolvers(SchemaDirectiveVisitor, defaultFieldResolver), useGraphiql: true, tracing: true})\r\n.registerGraphQlSchemas(UserSchema(app), PostSchema(app))\r\n.enum({name: 'Height', options: ['tall', 'short', 'average']})\r\n.enum({name: 'Role', options: ['Admin', 'User']})\r\n.listen(4000)\r\n","export async function resolveGraphqlOptions(options, ...args) {\r\n  if (typeof options === 'function') {\r\n    try {\r\n      return await options(...args)\r\n    } catch (e) {\r\n      throw new Error(`Invalid options provided to ApolloServer: ${e.message}`)\r\n    }\r\n  } else {\r\n    return options\r\n  }\r\n}\r\n","export { runQuery, LogFunction, LogMessage, LogStep, LogAction } from './runQuery'\r\nexport { runHttpQuery, HttpQueryError } from './runHttpQuery'\r\nexport { resolveGraphqlOptions } from './graphqlOptions'\r\n","import * as url from 'url'\r\nimport { GraphQLOptions, HttpQueryError, runHttpQuery } from './index'\r\nimport * as GraphiQL from 'apollo-server-module-graphiql'\r\n\r\nexport function graphqlExpress(options) {\r\n  if (!options) {\r\n    throw new Error('Apollo Server requires options.')\r\n  }\r\n\r\n  if (arguments.length > 1) {\r\n    // TODO: test this\r\n    throw new Error(`Apollo Server expects exactly one argument, got ${arguments.length}`)\r\n  }\r\n\r\n  const graphqlHandler = (req, res) => {\r\n    runHttpQuery([req, res], {\r\n      method: req.method,\r\n      options: options,\r\n      query: req.method === 'POST' ? req.body : req.query\r\n    }).then(\r\n      (gqlResponse) => {\r\n        res.setHeader('Content-Type', 'application/json')\r\n        res.setHeader('Content-Length', Buffer.byteLength(gqlResponse, 'utf8').toString())\r\n        res.write(gqlResponse)\r\n        res.end()\r\n      },\r\n      (error) => {\r\n        // if ('HttpQueryError' !== error.name) {\r\n        //   throw error\r\n        // }\r\n\r\n        if (error.headers) {\r\n          Object.keys(error.headers).forEach((header) => {\r\n            res.setHeader(header, error.headers[header])\r\n          })\r\n        }\r\n\r\n        res.statusCode = error.statusCode || 500\r\n        res.write(error.message)\r\n        res.end()\r\n      }\r\n    )\r\n  }\r\n\r\n  return graphqlHandler\r\n}\r\n\r\nexport function graphiqlExpress(options) {\r\n  const Handler = (req, res) => {\r\n    const query = req.url && url.parse(req.url, true).query\r\n    GraphiQL.resolveGraphiQLString(query, options, req).then(\r\n      (graphiqlString) => {\r\n        res.setHeader('Content-Type', 'text/html')\r\n        res.write(graphiqlString)\r\n        res.end()\r\n      },\r\n      (error) => {\r\n        throw error\r\n      }\r\n    )\r\n  }\r\n\r\n  return Handler\r\n}\r\n","import { parse, getOperationAST, DocumentNode, formatError, ExecutionResult } from 'graphql'\r\nimport { runQuery } from './runQuery'\r\nimport { default as GraphQLOptions, resolveGraphqlOptions } from './graphqlOptions'\r\n\r\nexport class HttpQueryError extends Error {\r\n  constructor(statusCode, message, isGraphQLError = false, headers) {\r\n    super(message)\r\n    this.name = 'HttpQueryError'\r\n    this.statusCode = statusCode\r\n    this.isGraphQLError = isGraphQLError\r\n    this.headers = headers\r\n  }\r\n}\r\n\r\nfunction isQueryOperation(query, operationName) {\r\n  const operationAST = getOperationAST(query, operationName)\r\n  return operationAST.operation === 'query'\r\n}\r\n\r\nexport async function runHttpQuery(handlerArguments, request) {\r\n  let isGetRequest = false\r\n  let optionsObject\r\n\r\n  try {\r\n    optionsObject = await resolveGraphqlOptions(request.options, ...handlerArguments)\r\n  } catch (e) {\r\n    throw new HttpQueryError(500, e.message)\r\n  }\r\n  const formatErrorFn = optionsObject.formatError || formatError\r\n  let requestPayload\r\n  switch (request.method) {\r\n    case 'POST':\r\n      if (!request.query || Object.keys(request.query).length === 0) {\r\n        throw new HttpQueryError(\r\n          500,\r\n          'POST body missing. Did you forget use body-parser middleware?'\r\n        )\r\n      }\r\n      requestPayload = request.query\r\n      break\r\n    case 'GET':\r\n      if (!request.query || Object.keys(request.query).length === 0) {\r\n        throw new HttpQueryError(400, 'GET query missing.')\r\n      }\r\n\r\n      isGetRequest = true\r\n      requestPayload = request.query\r\n      break\r\n\r\n    default:\r\n      throw new HttpQueryError(405, 'Apollo Server supports only GET/POST requests.', false, {\r\n        Allow: 'GET, POST'\r\n      })\r\n  }\r\n\r\n  let isBatch = true\r\n  // TODO: do something different here if the body is an array.\r\n  // Throw an error if body isn't either array or object.\r\n  if (!Array.isArray(requestPayload)) {\r\n    isBatch = false\r\n    requestPayload = [requestPayload]\r\n  }\r\n  const requests = requestPayload.map((requestParams) => {\r\n    try {\r\n      let query = requestParams.query\r\n      let extensions = requestParams.extensions\r\n      if (isGetRequest && extensions) {\r\n        // For GET requests, we have to JSON-parse extensions. (For POST\r\n        // requests they get parsed as part of parsing the larger body they're\r\n        // inside.)\r\n        try {\r\n          extensions = JSON.parse(extensions)\r\n        } catch (error) {\r\n          throw new HttpQueryError(400, 'Extensions are invalid JSON.')\r\n        }\r\n      }\r\n\r\n      if (query === undefined && extensions && extensions.persistedQuery) {\r\n        // It looks like we've received an Apollo Persisted Query. Apollo Server\r\n        // does not support persisted queries out of the box, so we should fail\r\n        // fast with a clear error saying that we don't support APQs. (A future\r\n        // version of Apollo Server may support APQs directly.)\r\n        throw new HttpQueryError(\r\n          // Return 200 to simplify processing: we want this to be intepreted by\r\n          // the client as data worth interpreting, not an error.\r\n          200,\r\n          JSON.stringify({\r\n            errors: [\r\n              {\r\n                message: 'PersistedQueryNotSupported'\r\n              }\r\n            ]\r\n          }),\r\n          true,\r\n          {\r\n            'Content-Type': 'application/json'\r\n          }\r\n        )\r\n      }\r\n\r\n      if (isGetRequest) {\r\n        if (typeof query === 'string') {\r\n          // preparse the query incase of GET so we can assert the operation.\r\n          // XXX This makes the type of 'query' in this function confused\r\n          //     which has led to us accidentally supporting GraphQL AST over\r\n          //     the wire as a valid query, which confuses users. Refactor to\r\n          //     not do this. Also, for a GET request, query really shouldn't\r\n          //     ever be anything other than a string or undefined, so this\r\n          //     set of conditionals doesn't quite make sense.\r\n          query = parse(query)\r\n        } else if (!query) {\r\n          // Note that we've already thrown a different error if it looks like APQ.\r\n          throw new HttpQueryError(400, 'Must provide query string.')\r\n        }\r\n\r\n        if (!isQueryOperation(query, requestParams.operationName)) {\r\n          throw new HttpQueryError(405, `GET supports only query operation`, false, {\r\n            Allow: 'POST'\r\n          })\r\n        }\r\n      }\r\n\r\n      const operationName = requestParams.operationName\r\n\r\n      let variables = requestParams.variables\r\n      if (typeof variables === 'string') {\r\n        try {\r\n          // XXX Really we should only do this for GET requests, but for\r\n          // compatibility reasons we'll keep doing this at least for now for\r\n          // broken clients that ship variables in a string for no good reason.\r\n          variables = JSON.parse(variables)\r\n        } catch (error) {\r\n          throw new HttpQueryError(400, 'Variables are invalid JSON.')\r\n        }\r\n      }\r\n\r\n      let context = optionsObject.context || {}\r\n      if (typeof context === 'function') {\r\n        context = context()\r\n      } else if (isBatch) {\r\n        context = Object.assign(Object.create(Object.getPrototypeOf(context)), context)\r\n      }\r\n      let params = {\r\n        schema: optionsObject.schema,\r\n        query: query,\r\n        variables: variables,\r\n        context,\r\n        rootValue: optionsObject.rootValue,\r\n        operationName: operationName,\r\n        logFunction: optionsObject.logFunction,\r\n        validationRules: optionsObject.validationRules,\r\n        formatError: formatErrorFn,\r\n        formatResponse: optionsObject.formatResponse,\r\n        fieldResolver: optionsObject.fieldResolver,\r\n        debug: optionsObject.debug,\r\n        tracing: optionsObject.tracing,\r\n        cacheControl: optionsObject.cacheControl\r\n      }\r\n\r\n      if (optionsObject.formatParams) {\r\n        params = optionsObject.formatParams(params)\r\n      }\r\n      return runQuery(params)\r\n    } catch (e) {\r\n      // Populate any HttpQueryError to our handler which should\r\n      // convert it to Http Error.\r\n      if (e.name === 'HttpQueryError') {\r\n        return Promise.reject(e)\r\n      }\r\n\r\n      return Promise.resolve({ errors: [formatErrorFn(e)] })\r\n    }\r\n  })\r\n  const responses = await Promise.all(requests)\r\n\r\n  if (!isBatch) {\r\n    const gqlResponse = responses[0]\r\n    if (gqlResponse.errors && typeof gqlResponse.data === 'undefined') {\r\n      throw new HttpQueryError(400, JSON.stringify(gqlResponse), true, {\r\n        'Content-Type': 'application/json'\r\n      })\r\n    }\r\n    return JSON.stringify(gqlResponse)\r\n  }\r\n\r\n  return JSON.stringify(responses)\r\n}\r\n","import {\r\n  GraphQLSchema,\r\n  GraphQLFieldResolver,\r\n  ExecutionResult,\r\n  DocumentNode,\r\n  parse,\r\n  print,\r\n  validate,\r\n  execute,\r\n  GraphQLError,\r\n  formatError,\r\n  specifiedRules,\r\n  ValidationContext\r\n} from 'graphql'\r\n\r\nimport {\r\n  enableGraphQLExtensions,\r\n  GraphQLExtension,\r\n  GraphQLExtensionStack\r\n} from 'graphql-extensions'\r\nimport { TracingExtension } from 'apollo-tracing'\r\nimport { CacheControlExtension, CacheControlExtensionOptions } from 'apollo-cache-control'\r\n\r\nexport const GraphQLResponse = {\r\n  data: {},\r\n  errors: [],\r\n  extensions: {}\r\n}\r\n\r\nexport const LogAction = {\r\n  request: '',\r\n  parse: '',\r\n  validation: '',\r\n  execute: ''\r\n}\r\n\r\nexport const LogStep = {\r\n  start: '',\r\n  end: '',\r\n  status: ''\r\n}\r\n\r\nexport const LogMessage = {\r\n  action: LogAction,\r\n  step: LogStep,\r\n  key: '',\r\n  data: {}\r\n}\r\n\r\nexport function LogFunction(message) {}\r\n\r\nexport const QueryOptions = {\r\n  schema: {},\r\n  query: '',\r\n  rootValue: {},\r\n  context: {},\r\n  variables: {},\r\n  operationName: '',\r\n  logFunction: LogFunction,\r\n  validationRules: [],\r\n  fieldResolver: {},\r\n  formatError: Function,\r\n  formatResponse: Function,\r\n  debug: false,\r\n  tracing: false,\r\n  cacheControl: false\r\n}\r\n\r\nexport function runQuery(options) {\r\n  // Fiber-aware Promises run their .then callbacks in Fibers.\r\n  return Promise.resolve().then(() => doRunQuery(options))\r\n}\r\n\r\nfunction printStackTrace(error) {\r\n  console.error(error.stack)\r\n}\r\n\r\nfunction format(errors, formatter) {\r\n  return errors.map((error) => {\r\n    if (formatter !== undefined) {\r\n      try {\r\n        return formatter(error)\r\n      } catch (err) {\r\n        console.error('Error in formatError function:', err)\r\n        const newError = new Error('Internal server error')\r\n        return formatError(newError)\r\n      }\r\n    } else {\r\n      return formatError(error)\r\n    }\r\n  })\r\n}\r\n\r\nfunction doRunQuery(options) {\r\n  let documentAST\r\n  const logFunction =\r\n    options.logFunction ||\r\n    function(...args) {\r\n      return args\r\n    }\r\n  const debugDefault = process.env.NODE_ENV !== 'production' && process.env.NODE_ENV !== 'test'\r\n  const debug = options.debug !== undefined ? options.debug : debugDefault\r\n\r\n  logFunction({ action: LogAction.request, step: LogStep.start })\r\n  const context = options.context || {}\r\n  let extensions = []\r\n  if (options.tracing) {\r\n    extensions.push(TracingExtension)\r\n  }\r\n  if (options.cacheControl === true) {\r\n    extensions.push(CacheControlExtension)\r\n  } else if (options.cacheControl) {\r\n    extensions.push(new CacheControlExtension(options.cacheControl))\r\n  }\r\n  const extensionStack = extensions.length > 0 && new GraphQLExtensionStack(extensions)\r\n\r\n  if (extensionStack) {\r\n    context._extensionStack = extensionStack\r\n    enableGraphQLExtensions(options.schema)\r\n\r\n    extensionStack.requestDidStart()\r\n  }\r\n  const qry = typeof options.query === 'string' ? options.query : print(options.query)\r\n  logFunction({\r\n    action: LogAction.request,\r\n    step: LogStep.status,\r\n    key: 'query',\r\n    data: qry\r\n  })\r\n  logFunction({\r\n    action: LogAction.request,\r\n    step: LogStep.status,\r\n    key: 'variables',\r\n    data: options.variables\r\n  })\r\n  logFunction({\r\n    action: LogAction.request,\r\n    step: LogStep.status,\r\n    key: 'operationName',\r\n    data: options.operationName\r\n  })\r\n\r\n  // if query is already an AST, don't parse or validate\r\n  // XXX: This refers the operations-store flow.\r\n  if (typeof options.query === 'string') {\r\n    try {\r\n      logFunction({ action: LogAction.parse, step: LogStep.start })\r\n      documentAST = parse(options.query)\r\n      logFunction({ action: LogAction.parse, step: LogStep.end })\r\n    } catch (syntaxError) {\r\n      logFunction({ action: LogAction.parse, step: LogStep.end })\r\n      return Promise.resolve({\r\n        errors: format([syntaxError], options.formatError)\r\n      })\r\n    }\r\n  } else {\r\n    documentAST = options.query\r\n    let rules = specifiedRules\r\n    if (options.validationRules) {\r\n      rules = rules.concat(options.validationRules)\r\n    }\r\n    logFunction({ action: LogAction.validation, step: LogStep.start })\r\n    const validationErrors = validate(options.schema, documentAST, rules)\r\n    logFunction({ action: LogAction.validation, step: LogStep.end })\r\n    if (validationErrors.length) {\r\n      return Promise.resolve({\r\n        errors: format(validationErrors, options.formatError)\r\n      })\r\n    }\r\n\r\n    if (extensionStack) {\r\n      extensionStack.executionDidStart()\r\n    }\r\n  }\r\n  try {\r\n    logFunction({ action: LogAction.execute, step: LogStep.start })\r\n    return Promise.resolve(\r\n      execute(\r\n        options.schema,\r\n        documentAST,\r\n        options.rootValue,\r\n        context,\r\n        options.variables,\r\n        options.operationName,\r\n        options.fieldResolver\r\n      )\r\n    ).then((result) => {\r\n      logFunction({ action: LogAction.execute, step: LogStep.end })\r\n      logFunction({ action: LogAction.request, step: LogStep.end })\r\n\r\n      let response = {\r\n        data: result.data\r\n      }\r\n\r\n      if (result.errors) {\r\n        response.errors = format(result.errors, options.formatError)\r\n        if (debug) {\r\n          result.errors.map(printStackTrace)\r\n        }\r\n      }\r\n\r\n      if (extensionStack) {\r\n        extensionStack.executionDidEnd()\r\n        extensionStack.requestDidEnd()\r\n        response.extensions = extensionStack.format()\r\n      }\r\n\r\n      if (options.formatResponse) {\r\n        response = options.formatResponse(response, options)\r\n      }\r\n      return response\r\n    })\r\n  } catch (executionError) {\r\n    logFunction({ action: LogAction.execute, step: LogStep.end })\r\n    logFunction({ action: LogAction.request, step: LogStep.end })\r\n    return Promise.resolve({\r\n      errors: format([executionError], options.formatError)\r\n    })\r\n  }\r\n}\r\n","// graphql handler, called from listen func when useGraphql is set to true\r\nexport default async function graphQlHandler({\r\n  server,\r\n  args,\r\n  _useGraphql,\r\n  _internal,\r\n  PubSub,\r\n  makeExecutableSchema,\r\n  getIntrospectSchema,\r\n  createHttpLink,\r\n  HttpLink,\r\n  fetch,\r\n  introspectSchema,\r\n  makeRemoteExecutableSchema,\r\n  mergeSchemas,\r\n  bodyParser,\r\n  graphiqlExpress,\r\n  graphqlExpress,\r\n  SubscriptionServer,\r\n  SubscriptionClient,\r\n  ws,\r\n  getMainDefinition,\r\n  split,\r\n  os,\r\n  print,\r\n  execute,\r\n  subscribe,\r\n  Promise,\r\n  _injected,\r\n  _Instance,\r\n  _version,\r\n  SchemaDirectiveVisitor,\r\n  GraphQLScalarType, \r\n  GraphQLNonNull,\r\n  defaultFieldResolver,\r\n  GraphQLString\r\n}) {\r\n  // init executableSchema, if directives length !== to their resolvers, throw error\r\n  let executableSchema = null\r\n  const directives = _useGraphql._graphQlDirectives\r\n  // if (directives.length !== Object.keys(_useGraphql.directiveResolvers).length) {\r\n  //   throw new Error(`Directive resolvers registered does not match directive declarations`)\r\n  // }\r\n  const enums = _useGraphql._graphQlEnums\r\n  const schemas = _useGraphql._graphQlSchemas.schemas\r\n  // use default pubsub for subscriptions if one is not passed\r\n  const pubsub = _useGraphql.pubsub || new PubSub()\r\n  // init graphql object, pass all app.inject to it and pubsub\r\n  const finalGraphQlOptionsObject = {\r\n    schema: executableSchema,\r\n    logger: _useGraphql.logger,\r\n    context: Object.assign({}, _injected, { pubsub }),\r\n    tracing: _useGraphql.tracing,\r\n    cacheControl: _useGraphql.cacheControl,\r\n    directiveResolvers: _useGraphql.directiveResolvers\r\n  }\r\n  // if remote endpoints is empty create local schemas, if not empty, create remote schemas\r\n  if (_useGraphql._graphQlRemoteEndpoints.length === 0) {\r\n    if (_useGraphql._graphQlExecutableSchema) {\r\n      // if schema passed from outside use it\r\n      executableSchema = _useGraphql._graphQlExecutableSchema\r\n    } else {\r\n      // create schema, run on all data received and assemble a valid schema\r\n      let Directives = ``\r\n      let Query = `type Query{\\n`\r\n      let Mutation = `type Mutation{\\n`\r\n      let Subscription = `type Subscription{\\n`\r\n      let Types = ``\r\n      let Enums = ``\r\n      let resolvers = { Query: {}, Mutation: {}, Subscription: {} }\r\n      enums.map((Enum) => {\r\n        Enums += `enum ${Enum.name}{\\n${Enum.options.map((option) => `\\t${option}\\n`).join('')}}\\n`\r\n      })\r\n      directives.map((dir) => {\r\n        Directives += dir.includes('directive') ? `${dir}\\n` : `directive ${dir}\\n`\r\n      })\r\n      schemas.map((schema) => {\r\n        const schemaProps = schema.getObjProps()\r\n        if (schemaProps.query) {\r\n          Query += `\\t${schemaProps.query}\\n`\r\n        }\r\n        if (schemaProps.mutation) {\r\n          Mutation += `\\t${schemaProps.mutation}\\n`\r\n        }\r\n        if (schemaProps.subscription) {\r\n          Subscription += `\\t${schemaProps.subscription}\\n`\r\n        }\r\n        if (schemaProps.type) {\r\n          Types += `${schemaProps.type}\\n`\r\n        }\r\n        if (schemaProps.resolver) {\r\n          const { Query, Mutation, Subscription, ...props } = schemaProps.resolver\r\n          if (Query) {\r\n            Object.assign(resolvers.Query, typeof Query === 'function' ? Query(pubsub) : Query)\r\n          }\r\n          if (Mutation) {\r\n            Object.assign(\r\n              resolvers.Mutation,\r\n              typeof Mutation === 'function' ? Mutation(pubsub) : Mutation\r\n            )\r\n          }\r\n          if (Subscription) {\r\n            Object.assign(\r\n              resolvers.Subscription,\r\n              typeof Subscription === 'function' ? Subscription(pubsub) : Subscription\r\n            )\r\n          }\r\n          Object.assign(resolvers, props)\r\n        }\r\n      })\r\n      if (Object.keys(resolvers.Query).length === 0) {\r\n        delete resolvers.Query\r\n      }\r\n      if (Object.keys(resolvers.Mutation).length === 0) {\r\n        delete resolvers.Mutation\r\n      }\r\n      if (Object.keys(resolvers.Subscription).length === 0) {\r\n        delete resolvers.Subscription\r\n      }\r\n      Query += '}'\r\n      Mutation += '}'\r\n      Subscription += '}'\r\n      let typeDefs = ``\r\n      if (Directives !== ``) {\r\n        typeDefs += `${Directives}\\n`\r\n      }\r\n      if (Enums !== ``) {\r\n        typeDefs += `${Enums}\\n`\r\n      }\r\n      if (Types !== ``) {\r\n        typeDefs += `${Types}\\n`\r\n      }\r\n      if (Query !== `type Query{\\n}`) {\r\n        typeDefs += `${Query}\\n`\r\n      }\r\n      if (Mutation !== `type Mutation{\\n}`) {\r\n        typeDefs += `${Mutation}\\n`\r\n      }\r\n      if (Subscription !== `type Subscription{\\n}`) {\r\n        typeDefs += `${Subscription}\\n`\r\n      }\r\n      finalGraphQlOptionsObject.rootValue = resolvers\r\n      executableSchema = makeExecutableSchema({\r\n        typeDefs,\r\n        resolvers\r\n        // directiveResolvers: _useGraphql.directiveResolvers\r\n      })\r\n      _useGraphql._graphQlExecutableSchema = executableSchema\r\n    }\r\n  } else {\r\n    const getIntrospectSchemaWithParams = getIntrospectSchema({\r\n      HttpLink,\r\n      fetch,\r\n      SubscriptionClient,\r\n      ws,\r\n      getMainDefinition,\r\n      split,\r\n      introspectSchema,\r\n      makeRemoteExecutableSchema\r\n    })\r\n    // if allowPartialRemoteSchema, catch all errors to allow partial schemas fetching\r\n    if (_useGraphql.allowPartialRemoteSchema) {\r\n      executableSchema = await Promise.map(_useGraphql._graphQlRemoteEndpoints, async (ep) => {\r\n        try {\r\n          return await getIntrospectSchemaWithParams(ep)\r\n        } catch (e) {\r\n          _useGraphql.logger.log(e)\r\n        }\r\n      }).filter((item) => item !== undefined)\r\n    } else {\r\n      // if allowPartialRemoteSchema is false, fire promise all, if something fails, all fails\r\n      executableSchema = await Promise.all(\r\n        _useGraphql._graphQlRemoteEndpoints.map((ep) => getIntrospectSchemaWithParams(ep))\r\n      )\r\n    }\r\n    // merge remote schemas\r\n    executableSchema = mergeSchemas({ schemas: executableSchema })\r\n    _useGraphql._graphQlExecutableSchema = executableSchema\r\n  }\r\n  // add directives\r\n  SchemaDirectiveVisitor.visitSchemaDirectives(executableSchema, Object.assign({}, _useGraphql.directiveResolvers))\r\n  // create bliz router and add middleware and graphiql and graphql to it\r\n  const router = _Instance.createRouter('/').middleware(bodyParser.json())\r\n  if (_useGraphql.useGraphiql) {\r\n    const graphiqlRoute = _Instance.createPath(_useGraphql.graphiqlRoute).handler(\r\n      graphiqlExpress({\r\n        endpointURL: _useGraphql.graphqlRoute,\r\n        subscriptionsEndpoint: `ws://localhost:${args[0]}${_useGraphql.subscriptionsEndpoint}`\r\n      })\r\n    )\r\n    router.get(graphiqlRoute)\r\n  }\r\n  finalGraphQlOptionsObject.schema = executableSchema\r\n  const graphqlRoute = _Instance.createPath(_useGraphql.graphqlRoute).handler(\r\n    graphqlExpress((req) => {\r\n      // pass headers and body to context\r\n      Object.assign(finalGraphQlOptionsObject.context, { headers: req.headers, body: req.body })\r\n      return finalGraphQlOptionsObject\r\n    })\r\n  )\r\n  router.get(graphqlRoute).post(graphqlRoute)\r\n  _Instance.registerRouters(router)\r\n  _Instance.events.emit('log')\r\n  // same as http server, only add a subscription server for graphql subscriptions\r\n  if (args.length > 1) {\r\n    const server = server.listen.apply(server, args)\r\n    SubscriptionServer.create(\r\n      {\r\n        execute,\r\n        subscribe,\r\n        schema: _useGraphql._graphQlExecutableSchema\r\n      },\r\n      {\r\n        server: server,\r\n        path: _useGraphql.subscriptionsEndpoint\r\n      }\r\n    )\r\n    return server\r\n  } else {\r\n    server.listen.apply(server, [\r\n      args[0],\r\n      () =>\r\n        print([\r\n          `Listening on Bliz server ${_version} on port ${args[0]}`,\r\n          `Platform: ${os.platform()}`,\r\n          `Hostname: ${os.hostname()}`,\r\n          `Architecture: ${os.arch()}`,\r\n          `CPU Cores: ${os.cpus().length}`,\r\n          `Memory Free: ${(\r\n            os.freemem() /\r\n            1024 /\r\n            1024 /\r\n            (os.totalmem() / 1024 / 1024) *\r\n            100\r\n          ).toFixed(0)}%, ${(os.freemem() / 1024 / 1024).toFixed(0)} MB / ${(\r\n            os.totalmem() /\r\n            1024 /\r\n            1024\r\n          ).toFixed(0)} MB`\r\n        ])\r\n    ])\r\n    SubscriptionServer.create(\r\n      {\r\n        execute,\r\n        subscribe,\r\n        schema: _useGraphql._graphQlExecutableSchema\r\n      },\r\n      {\r\n        server: server,\r\n        path: _useGraphql.subscriptionsEndpoint\r\n      }\r\n    )\r\n    return server\r\n  }\r\n}\r\n","import { AssignHandler, GetObjProps } from '../objectFactories'\r\n\r\n// graphql schema creator\r\nconst GraphQlSchemaCreator = (type) => {\r\n  const _graphql = {}\r\n  const _pathData = {\r\n    type,\r\n    resolver: {},\r\n    mutation: ``,\r\n    subscription: ``,\r\n    mockSchema: null,\r\n    query: ``\r\n  }\r\n  return Object.assign(\r\n    _graphql,\r\n    AssignHandler({\r\n      name: 'resolver',\r\n      obj: _pathData.resolver,\r\n      chainLink: _graphql,\r\n      override: true\r\n    }),\r\n    AssignHandler({ name: 'mockSchema', obj: _pathData, chainLink: _graphql }),\r\n    AssignHandler({ name: 'mutation', obj: _pathData, chainLink: _graphql }),\r\n    AssignHandler({ name: 'subscription', obj: _pathData, chainLink: _graphql }),\r\n    AssignHandler({ name: 'query', obj: _pathData, chainLink: _graphql }),\r\n    GetObjProps(_pathData)\r\n  )\r\n}\r\n\r\nexport default GraphQlSchemaCreator\r\n","// default error handler handler\r\nimport { StructError } from '../main'\r\n\r\n// default handler for http\r\n// if error passed from handler fire it\r\n// else if got here -> 404\r\nconst defaultErrorHandler = (req, res, err) => {\r\n  if (err) {\r\n    res.statusCode = err.status || 500\r\n    if (err instanceof StructError) {\r\n      res.json({\r\n        error: err.message,\r\n        path: err.path,\r\n        dataPassed: err.data,\r\n        valueReceived: err.value,\r\n        typeExpected: err.type\r\n      })\r\n    } else {\r\n      console.error(err)\r\n      res.json({ error: err.message })\r\n    }\r\n  } else {\r\n    res.statusCode = 404\r\n    res.json({ error: `${req.method.toUpperCase()} - ${req.url} not found...` })\r\n  }\r\n}\r\nexport default defaultErrorHandler\r\n","// main function\r\nfunction createHandler({\r\n  request,\r\n  response,\r\n  defaultHandler,\r\n  midHandler,\r\n  urlUtil,\r\n  handleNestedRoutersUtil,\r\n  populateParamsUtil,\r\n  populateQueryUtil,\r\n  populateUrlOptions,\r\n  _middleWares,\r\n  _routersObject,\r\n  _injected,\r\n  _Instance,\r\n  Promise\r\n}) {\r\n  // receive all middlewares from routers and apps if exist and concatanate them\r\n  _middleWares = _middleWares.reduce((prev, curr) => prev.concat(curr), [])\r\n  // handler to be passed to http.createServer\r\n  async function handler(req, res, next) {\r\n    // set proto of req and res to point to our req and res\r\n    req.__proto__ = request\r\n    res.__proto__ = response\r\n    // expose request and response to each other\r\n    response.req = req\r\n    request.res = res\r\n    if (!req.params) req.params = {}\r\n    if (!req.query) req.query = {}\r\n    // get url parts\r\n    let { method, splitRest } = urlUtil(req.url, req.method)\r\n    // check all url combinations possible\r\n    const urlCombinationOptions = populateUrlOptions(splitRest)\r\n    // get all middlewares collected on routers\r\n    const { baseOfRequest, rest, combinedRoutersMids } = handleNestedRoutersUtil(\r\n      urlCombinationOptions,\r\n      _routersObject\r\n    )\r\n    // populate req.query and return the final url to check on routers object\r\n    const finalRest = populateQueryUtil(req, rest) || rest\r\n    // populate req.params and return bool if need to skip param check or not\r\n    const { param, canSkipBecauseParams } = populateParamsUtil(\r\n      req,\r\n      _routersObject,\r\n      baseOfRequest,\r\n      method,\r\n      finalRest\r\n    )\r\n    // global middleware, if exists work with it, if throws error go to global handler\r\n    // check routers middleware\r\n    try {\r\n      // if global middlewares exists, execute them\r\n      if (_middleWares) {\r\n        await midHandler(Promise, req, res, _middleWares)\r\n      }\r\n      // if routers middlewares exist, execute them\r\n      if (combinedRoutersMids) {\r\n        await midHandler(Promise, req, res, combinedRoutersMids)\r\n      }\r\n    } catch (middleWareError) {\r\n      // in case of error in middlewares call defualt handler\r\n      return defaultHandler(req, res, middleWareError)\r\n    }\r\n    // something is not defined go to default handler\r\n    if (!canSkipBecauseParams) {\r\n      if (!_routersObject[baseOfRequest]) return defaultHandler(req, res)\r\n      if (!_routersObject[baseOfRequest][method]) return defaultHandler(req, res)\r\n      if (!_routersObject[baseOfRequest][method][finalRest]) return defaultHandler(req, res)\r\n    }\r\n    // current route after all checks\r\n    const currentRoute = _routersObject[baseOfRequest][method][\r\n      !canSkipBecauseParams ? finalRest : param\r\n    ].getObjProps()\r\n    // try router middleware => route middleware=> route handler=> if err check route err handler=>\r\n    // if err in err handler or err handler not exists => router err handler => if not go to global handler\r\n    try {\r\n      const { middleWareArr, describe, handler } = currentRoute\r\n      // if route middleware, execute\r\n      if (middleWareArr && middleWareArr.length > 0) {\r\n        await midHandler(Promise, req, res, middleWareArr)\r\n      }\r\n      // if validation schemes exist, execute them\r\n      if (describe && describe.incoming && describe.incoming.length > 0) {\r\n        for (let i = 0; i < describe.incoming.length; i++) {\r\n          let searchIn = ''\r\n          if (describe.incoming[i].in === 'path') {\r\n            searchIn = 'params'\r\n          } else {\r\n            searchIn = describe.incoming[i].in\r\n          }\r\n          describe.incoming[i].schema(req[searchIn])\r\n        }\r\n      }\r\n      // call handler with req, res and injected object from app.inject\r\n      if (describe && describe.incoming && describe.incoming.length > 0) {\r\n        const statusObject = {}\r\n        for (let schema of describe.outgoing) {\r\n          statusObject[schema.status] = schema.schema\r\n        }\r\n        Object.assign(res, { schema: statusObject })\r\n      }\r\n\r\n      await handler(req, res, _injected)\r\n    } catch (errorFromHandler) {\r\n      // here, it is the same as with middlewares but backwards, try route err handler, next up try router err handler and finally try global middleware\r\n      try {\r\n        if (currentRoute.errHandler) {\r\n          currentRoute.errHandler(req, res, errorFromHandler)\r\n        } else if (_routersObject[baseOfRequest].routerErrorHandler) {\r\n          _routersObject[baseOfRequest].routerErrorHandler(req, res, errorFromHandler)\r\n        } else {\r\n          defaultHandler(req, res, errorFromHandler)\r\n        }\r\n      } catch (errorFromErrorHandlers) {\r\n        defaultHandler(req, res, errorFromErrorHandlers)\r\n      }\r\n    }\r\n  }\r\n  return { handler }\r\n}\r\n\r\nexport default createHandler\r\n","import { struct } from 'superstruct'\r\nimport { assign } from '../utils'\r\n\r\nconst contactStruct = struct({\r\n  name: 'string?',\r\n  email: 'string?',\r\n  url: 'string?'\r\n})\r\n\r\nconst licenseStruct = struct({\r\n  name: 'string?',\r\n  url: 'string?'\r\n})\r\n\r\nconst serverStruct = struct({\r\n  url: 'string?',\r\n  description: 'string?'\r\n})\r\n\r\nconst infoStruct = struct({\r\n  title: 'string',\r\n  version: 'string',\r\n  description: 'string?',\r\n  termsOfService: 'string?',\r\n  contact: contactStruct,\r\n  license: licenseStruct\r\n})\r\n\r\nconst mainDescribeStruct = struct({\r\n  openapi: 'string',\r\n  security: 'array?',\r\n  info: infoStruct,\r\n  servers: [serverStruct]\r\n})\r\n\r\n// mainDescribe block\r\nconst mainDescribe = ({\r\n  title,\r\n  version,\r\n  description,\r\n  termsOfService,\r\n  contact,\r\n  license,\r\n  servers,\r\n  security\r\n}) => {\r\n  const validJson = {\r\n    openapi: '3.0.0',\r\n    security,\r\n    info: {\r\n      title,\r\n      version,\r\n      description,\r\n      termsOfService,\r\n      contact,\r\n      license\r\n    },\r\n    servers\r\n  }\r\n  return mainDescribeStruct(validJson)\r\n}\r\n\r\nconst singlePathMetaData = struct({\r\n  tags: ['string'],\r\n  description: 'string',\r\n  parameters: 'array?',\r\n  requestBody: 'object?',\r\n  summary: 'string?',\r\n  responses: 'object?'\r\n})\r\n\r\nconst methodStruct = (methodName) =>\r\n  struct({\r\n    [methodName === 'del' ? 'delete' : methodName]: singlePathMetaData\r\n  })\r\n\r\nconst pathStruct = (pathName, methodName) =>\r\n  struct({\r\n    [pathName]: methodStruct(methodName)\r\n  })\r\n\r\n// recurse on structs and populate object according to struct received\r\nconst getNested = (struct, map = {}) => {\r\n  const schema = (struct.schema && struct.schema.schema) || struct.schema\r\n  const keys = Object.keys(schema)\r\n  for (let key of keys) {\r\n    // console.log(key, schema[key])\r\n    if (schema[key].kind && schema[key].kind === 'object') {\r\n      const result = getNested(schema[key], {})\r\n      assign(map, [key, 'type'], 'object')\r\n      assign(map, [key, 'properties'], result)\r\n      // assign(map, [key], result)\r\n    } else if (schema[key].kind && schema[key].kind === 'list') {\r\n      // console.log(`schema[key]`, schema[key].type)\r\n      assign(map, [key, 'type'], 'array')\r\n      let type = schema[key].type.replace(/\\[|\\]/g, '')\r\n      assign(map, [key, 'items', 'type'], type.replace('?', ''))\r\n    } else if (schema[key].kind && schema[key].kind === 'enum') {\r\n      assign(map, [key, 'type'], 'string')\r\n      assign(\r\n        map,\r\n        [key, 'enum'],\r\n        schema[key].type.split('|').map((item) => item.replace(/\\\"/g, '').replace(/\\s/g, ''))\r\n      )\r\n    } else if (schema[key].kind && schema[key].kind === 'scalar') {\r\n      assign(map, [key], schema[key].type)\r\n    } else if (schema[key].kind && schema[key].kind === 'dict') {\r\n      assign(map, [key, 'type'], 'object')\r\n      const type = schema[key].type.replace(/dict\\<|\\>/g, '')\r\n      assign(map, [key, 'type'], type.substring(type.indexOf(',') + 1))\r\n    } else if (schema[key].kind && schema[key].kind === 'function') {\r\n    } else if (schema[key].kind && schema[key].kind === 'instance') {\r\n    } else if (schema[key].kind && schema[key].kind === 'interface') {\r\n    } else if (schema[key].kind && schema[key].kind === 'intersection') {\r\n      const types = schema[key].type\r\n        .split('&')\r\n        .map((item) => item.replace(/\\s/g, ''))\r\n        .map((item) => 'type: ' + item)\r\n      assign(map, [key, 'allOf'], types)\r\n    } else if (schema[key].kind && schema[key].kind === 'literal') {\r\n      // const types = schema[key].type.replace(/literal:|\\s/g, '')\r\n      // assign(map, [key, 'type'], types)\r\n    } else if (schema[key].kind && schema[key].kind === 'lazy') {\r\n    } else if (schema[key].kind && schema[key].kind === 'tuple') {\r\n    } else if (schema[key].kind && schema[key].kind === 'union') {\r\n      const types = schema[key].type\r\n        .split('|')\r\n        .map((item) => item.replace(/\\s/g, ''))\r\n        .map((item) => 'type: ' + item)\r\n      assign(map, [key, 'anyOf'], types)\r\n    } else {\r\n      // console.log(key, schema[key])\r\n      // console.log(`assigning type array`, key, schema[key])\r\n      assign(map, [key, 'type'], schema[key].replace('?', ''))\r\n      if (schema[key] === 'array') {\r\n        assign(map, [key, 'items', 'type'], 'object')\r\n      }\r\n    }\r\n  }\r\n  // console.log(`map:`, map)\r\n  return map\r\n}\r\n\r\n// add request schema based on path, method and request object\r\nconst addRequest = (request, path, method) => {\r\n  // console.log(`REQUEST: `, request)\r\n  if (!request) return\r\n  return {\r\n    content: {\r\n      [request.contentType || 'application/json']: {\r\n        schema: {\r\n          $ref: `#/components/schemas/${path\r\n            .replace(/\\//g, '')\r\n            .replace(/-/, '')\r\n            .replace(/[{|}]/g, '')}-body-${method}`\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// build response object\r\nconst responseBuilder = (responses, path, method) => {\r\n  const responseObject = {}\r\n  for (let resp of responses) {\r\n    responseObject[resp.status] = {\r\n      description: `${resp.status}`,\r\n      content: {\r\n        [resp.contentType || 'application/json']: {\r\n          schema: {\r\n            $ref: `#/components/schemas/${path\r\n              .replace(/\\//g, '')\r\n              .replace(/-/, '')\r\n              .replace(/[{|}]/g, '')}-${resp.status}-${method}`\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return responseObject\r\n}\r\n\r\n// describe path based on data received\r\nconst pathDescribe = ({\r\n  path,\r\n  method,\r\n  tags,\r\n  description,\r\n  summary,\r\n  incoming,\r\n  requestBody,\r\n  outgoing\r\n}) => {\r\n  // console.log(Object.keys(requests[0].schema.schema))\r\n  const myRegexp = /(:.+?)([\\/]|$)/g\r\n  const swaggerPath = path.replace(myRegexp, function(...args) {\r\n    return args[0].replace(args[1], `{${args[1].replace(':', '')}}`)\r\n  })\r\n  const bodyRequests = incoming.filter((request) => request.in === 'body')\r\n  const parametersRequests = incoming.filter((request) => ['path', 'query'].includes(request.in))\r\n  const injectedPathWithParams = pathStruct(swaggerPath, method)\r\n  const parametersToInject = parametersRequests\r\n    .map((request) => {\r\n      // const all\r\n      const arrayToConcat = []\r\n      const map = getNested(request, {})\r\n      const keys = Object.keys(map)\r\n      for (let key of keys) {\r\n        const obj = {}\r\n        obj.name = key\r\n        obj.in = request.in\r\n        obj.required = !map[key]['type'].includes('?')\r\n        obj.schema = {}\r\n        obj.schema.type = map[key]['type'].replace('?', '')\r\n        arrayToConcat.push(obj)\r\n      }\r\n      return arrayToConcat\r\n      // console.log(objectToReturn)\r\n    })\r\n    .reduce((prev, curr) => prev.concat(curr), [])\r\n\r\n  const jsonWithParams = {\r\n    [swaggerPath]: {\r\n      [method === 'del' ? 'delete' : method]: {\r\n        tags,\r\n        description,\r\n        summary,\r\n        requestBody: addRequest(bodyRequests[0], swaggerPath, method),\r\n        parameters: parametersToInject.length > 0 ? parametersToInject : undefined,\r\n        responses: responseBuilder(outgoing, swaggerPath, method)\r\n      }\r\n    }\r\n  }\r\n  return injectedPathWithParams(jsonWithParams)\r\n}\r\n\r\n// schema builder according to describe.requests object and describe.responses\r\nconst schemas = (schemas, securitySchemes) => {\r\n  const schemasObject = {}\r\n  for (let sc of schemas) {\r\n    const data = getNested(sc)\r\n    schemasObject[sc.name] = data[Object.keys(data)[0]]\r\n  }\r\n  return {\r\n    components: {\r\n      securitySchemes,\r\n      schemas: schemasObject\r\n    }\r\n  }\r\n}\r\nexport { pathDescribe, schemas, mainDescribe }\r\n","import { AssignHandler, GetObjProps, CreateObjectArray } from '../objectFactories'\r\n\r\nimport { checkBaseUtil } from '../utils'\r\n\r\n// path creator\r\nconst PathCreator = (path) => {\r\n  const _PathReturn = {}\r\n  const _pathData = {\r\n    middleWareArr: [],\r\n    path: checkBaseUtil(path),\r\n    describe: {},\r\n    handler: null,\r\n    errHandler: null,\r\n    parent: null\r\n  }\r\n  return Object.assign(\r\n    _PathReturn,\r\n    AssignHandler({\r\n      name: 'describe',\r\n      obj: _pathData.describe,\r\n      chainLink: _PathReturn,\r\n      override: true\r\n    }),\r\n    AssignHandler({\r\n      name: 'parent',\r\n      obj: _pathData.parent,\r\n      chainLink: _PathReturn,\r\n      override: true\r\n    }),\r\n    CreateObjectArray({ name: 'middleware', arr: _pathData.middleWareArr, chainLink: _PathReturn }),\r\n    AssignHandler({ name: 'handler', obj: _pathData, chainLink: _PathReturn }),\r\n    AssignHandler({ name: 'errHandler', obj: _pathData, chainLink: _PathReturn }),\r\n    GetObjProps(_pathData)\r\n  )\r\n}\r\n\r\nexport default PathCreator\r\n","import http from 'http'\r\n\r\nconst req = Object.create(http.IncomingMessage.prototype)\r\n\r\nexport default req\r\n","import http from 'http'\r\nimport etag from 'etag'\r\n\r\nconst res = Object.create(http.ServerResponse.prototype)\r\n\r\nres.status = function(status) {\r\n  this.statusCode = status\r\n  return this\r\n}\r\n\r\nres.json = function(data) {\r\n  // console.log(this.req.headers)\r\n  this.setHeader('Content-Type', 'application/json')\r\n  this.setHeader('X-Powered-By', 'Bliz')\r\n  const stringified = JSON.stringify(data, null, 3)\r\n  const generatedEtag = etag(stringified)\r\n  // console.log(generatedEtag, this.req.headers.etag)\r\n  this.setHeader('ETag', generatedEtag)\r\n  this.end(stringified)\r\n}\r\n\r\n// res.vjson = function(data){\r\n//   console.log(this, data, this.statusCode)\r\n//   if(this.schema[this.statusCode]){\r\n//     this.schema[this.statusCode](data)\r\n//   }else {\r\n//     console.warn('no matching schema for status ' + this.statusCode)\r\n//     this.json(data)\r\n//   }\r\n// }\r\n\r\nexport default res\r\n","import {\r\n  CreateArray,\r\n  CreateObjectArray,\r\n  AssignHandler,\r\n  GetObjProps,\r\n  Method\r\n} from '../objectFactories'\r\nimport { checkBaseUtil } from '../utils'\r\n\r\n// router creator\r\nconst RouterCreator = (base) => {\r\n  const _RouterReturn = {}\r\n  const _routerData = {\r\n    base: checkBaseUtil(base),\r\n    get: {},\r\n    post: {},\r\n    put: {},\r\n    del: {},\r\n    middleWareArr: [],\r\n    subRouters: [],\r\n    routerErrorHandler: null\r\n  }\r\n  return Object.assign(\r\n    _RouterReturn,\r\n    Method('get', _routerData, _RouterReturn),\r\n    Method('post', _routerData, _RouterReturn),\r\n    Method('put', _routerData, _RouterReturn),\r\n    Method('del', _routerData, _RouterReturn),\r\n    AssignHandler({ name: 'routerErrorHandler', obj: _routerData, chainLink: _RouterReturn }),\r\n    CreateObjectArray({\r\n      name: 'middleware',\r\n      arr: _routerData.middleWareArr,\r\n      chainLink: _RouterReturn\r\n    }),\r\n    CreateArray({ name: 'subRouter', obj: _routerData.subRouters, chainLink: _RouterReturn }),\r\n    GetObjProps(_routerData)\r\n  )\r\n}\r\n\r\nexport default RouterCreator\r\n","// package json\r\nimport 'babel-polyfill'\r\nimport packgeJson from '../package.json'\r\n\r\n// http dependencies\r\nimport RouterCreator from './http/router'\r\nimport PathCreator from './http/path'\r\nimport defaultHandler from './http/defaultHandler'\r\nimport CreateHandler from './http/handler'\r\nimport request from './http/request'\r\nimport response from './http/response'\r\nimport midHandler, { socketMiddlewareHandler } from './middlewareHandler'\r\nimport SocketRouterCreator from './sockets/socketRouter'\r\nimport SocketListenerCreator from './sockets/socketListener'\r\nimport socketHandler from './sockets/socketHandler'\r\n\r\n// graphql dependencies\r\nimport GraphQlCreator from './graphql/graphQlSchema'\r\nimport graphqlHandler from './graphql/graphQlHandler'\r\nimport { GraphQLScalarType, GraphQLNonNull, defaultFieldResolver, GraphQLString } from 'graphql'\r\nimport { graphqlExpress, graphiqlExpress } from './apolloServer/main'\r\nimport {\r\n  makeExecutableSchema,\r\n  mergeSchemas,\r\n  makeRemoteExecutableSchema,\r\n  introspectSchema,\r\n  SchemaDirectiveVisitor\r\n} from 'graphql-tools'\r\nimport { getIntrospectSchema } from './utils'\r\nimport ws from 'ws'\r\nimport { split } from 'apollo-client-preset'\r\nimport { getMainDefinition } from 'apollo-utilities'\r\nimport { SubscriptionServer, SubscriptionClient } from 'subscriptions-transport-ws'\r\nimport { execute, subscribe } from 'graphql'\r\nimport { PubSub } from 'graphql-subscriptions'\r\nimport fetch from 'node-fetch'\r\nimport { createHttpLink, HttpLink } from 'apollo-link-http'\r\n\r\n// app dependencies\r\nimport * as factories from './objectFactories'\r\nimport * as utils from './utils'\r\nimport RegisterRouters from './registerRouters'\r\nimport { pathDescribe, mainDescribe, schemas } from './http/openApi'\r\nimport bodyParser from 'body-parser'\r\nimport http from 'http'\r\nimport fs from 'fs'\r\nimport treeify from 'treeify'\r\nimport { struct, superstruct, StructError } from 'superstruct'\r\nimport EventEmitter from 'eventemitter2'\r\nimport Promise from 'bluebird'\r\nimport { stringify } from 'json-to-pretty-yaml'\r\nimport print from 'print-message'\r\nimport os from 'os'\r\nimport io from 'socket.io'\r\n\r\nconst httpDependencies = {\r\n  RouterCreator,\r\n  PathCreator,\r\n  defaultHandler,\r\n  CreateHandler,\r\n  request,\r\n  response,\r\n  midHandler,\r\n  pathDescribe,\r\n  mainDescribe,\r\n  schemas\r\n}\r\n\r\nconst graphqlDependencies = {\r\n  GraphQlCreator,\r\n  graphqlExpress,\r\n  graphiqlExpress,\r\n  graphqlHandler,\r\n  SubscriptionServer,\r\n  execute,\r\n  subscribe,\r\n  PubSub,\r\n  mergeSchemas,\r\n  makeRemoteExecutableSchema,\r\n  getIntrospectSchema,\r\n  fetch,\r\n  introspectSchema,\r\n  createHttpLink,\r\n  HttpLink,\r\n  SubscriptionClient,\r\n  ws,\r\n  getMainDefinition,\r\n  split,\r\n  SchemaDirectiveVisitor,\r\n  GraphQLScalarType, \r\n  GraphQLNonNull,\r\n  defaultFieldResolver,\r\n  GraphQLString\r\n}\r\n\r\nconst socketDependencies = {\r\n  SocketListenerCreator,\r\n  SocketRouterCreator,\r\n  socketMiddlewareHandler,\r\n  socketHandler\r\n}\r\n\r\nconst superStructObject = {\r\n  struct,\r\n  superstruct,\r\n  StructError\r\n}\r\n\r\nconst appDependencies = {\r\n  bodyParser,\r\n  http,\r\n  io,\r\n  makeExecutableSchema,\r\n  fs,\r\n  treeify,\r\n  EventEmitter,\r\n  Promise,\r\n  stringify,\r\n  print,\r\n  os,\r\n  packgeJson,\r\n  RegisterRouters\r\n}\r\n\r\n// combining all dependencies to one object for convenience.\r\nconst BlizAppParams = {\r\n  ...utils,\r\n  ...factories,\r\n  ...httpDependencies,\r\n  ...graphqlDependencies,\r\n  ...socketDependencies,\r\n  ...appDependencies,\r\n  superStructObject\r\n}\r\n\r\n// main instance creator, returns an instance of bliz app\r\n// using concatanative inheritance + RORO (receive object return object)\r\nconst BlizApp = (BlizAppParams) => {\r\n  // internal information\r\n  // _Instance - all instance data\r\n  // _injected - all data passed, will be injected to all handlers\r\n  // _options - options object, still did not implement anything for it\r\n  // _loggerEntity - holds the structure of sockets and http routes when calling pretty print\r\n  const _internal = {\r\n    _version: BlizAppParams.packgeJson.version,\r\n    _Instance: {},\r\n    _injected: {},\r\n    _options: {},\r\n    _loggerEntity: { sockets: {}, http: {} }\r\n  }\r\n  // socekt.io object, _socketSubApps was not yet implemented\r\n  const _useSockets = {\r\n    useSockets: false,\r\n    delimiter: ':',\r\n    _socketRoutersObject: {},\r\n    _socketMiddlewares: [],\r\n    _socketSubApps: []\r\n  }\r\n  // graphql config object\r\n  const _useGraphql = {\r\n    useGraphql: false,\r\n    graphqlRoute: '/graphql',\r\n    graphiqlRoute: '/graphiql',\r\n    _graphQlRemoteEndpoints: [],\r\n    _graphQlExecutableSchema: null,\r\n    _graphQlSchemas: {},\r\n    _graphQlDirectives: [],\r\n    _graphQlEnums: [],\r\n    subscriptionsEndpoint: '/subscriptions',\r\n    useGraphiql: true,\r\n    logger: { log: (e) => console.log(`Error from graphql: `, e) },\r\n    directiveResolvers: {},\r\n    tracing: true,\r\n    cacheControl: {\r\n      defaultMaxAge: 5\r\n    }\r\n  }\r\n  // http object, _describe is added by each component as .describe, used for swagger.yaml generation\r\n  const _useHttp = {\r\n    useSwagger: false,\r\n    _middleWares: [],\r\n    _routersObject: {},\r\n    _describe: {},\r\n    _subApps: []\r\n  }\r\n\r\n  // entire app data, used when calling getObjProps() on app\r\n  const _appData = {\r\n    _useSockets,\r\n    _useGraphql,\r\n    _useHttp\r\n  }\r\n\r\n  // binding all data and dependencies to the http handler\r\n  const _createHandler = CreateHandler.bind(this, { ...BlizAppParams, ..._useHttp })\r\n  // destructuring for passing to allow chaining on methods\r\n  const { _Instance, _options, _injected, _loggerEntity, _version } = _internal\r\n\r\n  // call all function and pass dependencies to them and compose methods, put all on the Instance object\r\n  return Object.assign(\r\n    _Instance,\r\n    BlizAppParams.CreateNewObjOf({ name: 'GraphQlSchema', obj: GraphQlCreator }),\r\n    BlizAppParams.CreateNewObjOf({\r\n      name: 'SocketRouter',\r\n      obj: SocketRouterCreator,\r\n      dependencies: { ...BlizAppParams }\r\n    }),\r\n    BlizAppParams.CreateNewObjOf({\r\n      name: 'SocketListener',\r\n      obj: SocketListenerCreator,\r\n      dependencies: { ...BlizAppParams }\r\n    }),\r\n    BlizAppParams.CreateNewObjOf({\r\n      name: 'Router',\r\n      obj: RouterCreator,\r\n      dependencies: { ...BlizAppParams }\r\n    }),\r\n    BlizAppParams.CreateNewObjOf({\r\n      name: 'Path',\r\n      obj: PathCreator,\r\n      dependencies: { ...BlizAppParams }\r\n    }),\r\n    BlizAppParams.AssignHandler({\r\n      name: 'sockets',\r\n      obj: _useSockets,\r\n      chainLink: _Instance,\r\n      override: true\r\n    }),\r\n    BlizAppParams.AssignHandler({\r\n      name: 'graphql',\r\n      obj: _useGraphql,\r\n      chainLink: _Instance,\r\n      override: true\r\n    }),\r\n    BlizAppParams.AssignHandler({\r\n      name: 'describe',\r\n      obj: _useHttp._describe,\r\n      chainLink: _Instance,\r\n      override: true\r\n    }),\r\n    BlizAppParams.AssignHandler({\r\n      name: 'options',\r\n      obj: _options,\r\n      chainLink: _Instance,\r\n      override: true\r\n    }),\r\n    BlizAppParams.AssignHandler({\r\n      name: 'inject',\r\n      obj: _injected,\r\n      chainLink: _Instance,\r\n      override: true\r\n    }),\r\n    BlizAppParams.CreateObjectArray({\r\n      name: 'middleware',\r\n      arr: _useHttp._middleWares,\r\n      chainLink: _Instance\r\n    }),\r\n    BlizAppParams.CreateObjectArray({\r\n      name: 'socketMiddleware',\r\n      arr: _useSockets._socketMiddlewares,\r\n      chainLink: _Instance\r\n    }),\r\n    BlizAppParams.CreateArray({ name: 'subApp', arr: _useHttp._subApps, chainLink: _Instance }),\r\n    BlizAppParams.CreateArray({\r\n      name: 'enum',\r\n      arr: _useGraphql._graphQlEnums,\r\n      chainLink: _Instance\r\n    }),\r\n    BlizAppParams.CreateArray({\r\n      name: 'directive',\r\n      arr: _useGraphql._graphQlDirectives,\r\n      chainLink: _Instance\r\n    }),\r\n    BlizAppParams.CreateSwagger({ ..._appData, ...BlizAppParams, _Instance }),\r\n    BlizAppParams.PrettyPrint({ ..._appData, ...BlizAppParams, _Instance, _loggerEntity }),\r\n    BlizAppParams.RegisterRouters({ ..._appData, ...BlizAppParams, _Instance }),\r\n    BlizAppParams.EventsCreator(BlizAppParams.EventEmitter),\r\n    BlizAppParams.GetObjProps(_appData),\r\n    BlizAppParams.Listen({\r\n      _createHandler,\r\n      ..._appData,\r\n      ...BlizAppParams,\r\n      _Instance,\r\n      _version,\r\n      _injected\r\n    })\r\n  )\r\n}\r\n\r\n// exposed factory to create a new instance\r\nconst BlizCreator = () => {\r\n  return Object.assign({}, BlizApp(BlizAppParams))\r\n}\r\n\r\n// expose factory and superstruct for validation, request + response for extending http req and res\r\nexport default BlizCreator\r\nexport { request, response, struct, superstruct, StructError, SchemaDirectiveVisitor, defaultFieldResolver }\r\n","// next function that resolves if called next(), if next is called with args it rejects, like in express\r\nfunction next(resolve, reject, ...args) {\r\n  if (args.length > 0) return reject(args[0])\r\n  return resolve()\r\n}\r\n\r\n// race the timeout promise with the promise provided, used to timeout the middlewares\r\nconst promiseTimeout = (promise, ms, throwError) => {\r\n  // Create a promise that rejects in <ms> milliseconds\r\n  let timeout = new Promise((resolve, reject) => {\r\n    let id = setTimeout(() => {\r\n      clearTimeout(id)\r\n      const err = new Error('Timed out in ' + ms + 'ms.')\r\n      throwError ? reject(err) : resolve('Timed out in ' + ms + 'ms.')\r\n    }, ms)\r\n  })\r\n\r\n  // Returns a race between our timeout and the passed in promise\r\n  return Promise.race([promise, timeout])\r\n}\r\n\r\n// handler for express middlewares with next...\r\nasync function midHandler(Promise, req, res, arr) {\r\n  for (let item of arr) {\r\n    const { fn, timeout, throwError } = item\r\n    await new Promise((resolve, reject) =>\r\n      fn(req, res, next.bind(this, resolve, reject))\r\n    )\r\n    // const data = await promiseTimeout(handlerPromise, timeout, throwError)\r\n  }\r\n}\r\n\r\n// handler for socket middlewares with next\r\nasync function socketMiddlewareHandler(Promise, io, socket, msg, cb, arr) {\r\n  // run on middleware array and wait for each sequentially\r\n  for (let item of arr) {\r\n    const { fn, timeout, throwError } = item\r\n    const handlerPromise = new Promise((resolve, reject) =>\r\n      fn(io, socket, msg, cb, next.bind(this, resolve, reject))\r\n    )\r\n    await promiseTimeout(handlerPromise, timeout, throwError)\r\n  }\r\n}\r\n\r\nexport { socketMiddlewareHandler }\r\nexport default midHandler\r\n","// receive an http and a handler and return a listen func\r\nconst Listen = (dependencies) => ({\r\n  createServer: (...args) => {\r\n    const {\r\n      http: { createServer },\r\n      _createHandler\r\n    } = dependencies\r\n    const { handler } = _createHandler()\r\n    const server = createServer(handler)\r\n    return server\r\n  },\r\n  // listen function that starts the app\r\n  // if sockets -> use socket handler\r\n  // else if graphql -> use graphql handler\r\n  // else -> use http handler\r\n  // on each handler fire log event, used to notify log listener to log after all routes and middlewares have been processed and app is ready.\r\n  listen: (...args) => {\r\n    const {\r\n      http: { createServer },\r\n      io,\r\n      socketHandler,\r\n      graphqlHandler,\r\n      _createHandler,\r\n      _useSockets,\r\n      _version,\r\n      _useGraphql,\r\n      _Instance,\r\n      print,\r\n      os\r\n    } = dependencies\r\n    const { handler } = _createHandler()\r\n    const server = createServer(handler)\r\n    if (_useSockets.useSockets) {\r\n      _useSockets.io = io\r\n      return socketHandler({ server, args, ...dependencies })\r\n    } else if (_useGraphql.useGraphql) {\r\n      return graphqlHandler({ server, args, ...dependencies })\r\n    } else {\r\n      _Instance.events.emit('log')\r\n      if (args.length > 1) {\r\n        return server.listen.apply(server, args)\r\n      } else {\r\n        // print os information and Bliz information\r\n        return server.listen.apply(server, [\r\n          args[0],\r\n          () =>\r\n            print([\r\n              `Listening on Bliz server ${_version} on port ${args[0]}`,\r\n              `Platform: ${os.platform()}`,\r\n              `Hostname: ${os.hostname()}`,\r\n              `Architecture: ${os.arch()}`,\r\n              `CPU Cores: ${os.cpus().length}`,\r\n              `Memory Free: ${(os.freemem() / os.totalmem() * 100).toFixed(0)}%, ${(\r\n                os.freemem() /\r\n                1024 /\r\n                1024\r\n              ).toFixed(0)} MB / ${(os.totalmem() / 1024 / 1024).toFixed(0)} MB`\r\n            ])\r\n        ])\r\n      }\r\n    }\r\n  }\r\n})\r\n\r\n// TODO: implement cluster support on sockets\r\nconst Cluster = ({ _version }) => ({\r\n  // stage 1\r\n  // get options\r\n  // get routers, schemas\r\n  // open redis client\r\n  // ask redis for bliz cluster version\r\n  // if same version - continue\r\n  // else - different versions between cluster servers, throw error (update server)\r\n  // stage 2\r\n  // create server hash\r\n  // write hash to redis\r\n  // stage 3\r\n  // open redis subscriber for divide work\r\n  // open redis subscriber for receive work\r\n  // stage 4\r\n  // when query comes, round robin or options to choose random server (subscribers / hash ??)\r\n  // fire divide work event to chosen server\r\n  // if chosen master\r\n  // divide work totalSchemas / registered servers on cluster\r\n})\r\n\r\n// pretty print all app routes\r\nconst PrettyPrint = ({\r\n  _useHttp,\r\n  _useSockets,\r\n  _Instance,\r\n  _loggerEntity,\r\n  populateObjectWithTreeUtil,\r\n  treeify\r\n}) => ({\r\n  prettyPrint: (logger = console.log) => {\r\n    _Instance.events.once('log', () =>\r\n      setImmediate(() => {\r\n        populateObjectWithTreeUtil(\r\n          _useHttp._routersObject,\r\n          ['get', 'post', 'put', 'del'],\r\n          _loggerEntity.http\r\n        )\r\n        populateObjectWithTreeUtil(\r\n          _useSockets._socketRoutersObject,\r\n          ['event'],\r\n          _loggerEntity.sockets,\r\n          _useSockets.delimiter\r\n        )\r\n        logger(treeify.asTree(_loggerEntity))\r\n      }, 0)\r\n    )\r\n    return _Instance\r\n  }\r\n})\r\n\r\n// method creator for router\r\nconst Method = (name, object, chainLink) => ({\r\n  [name]: (data) => {\r\n    object[name][data.getObjProps().path] = data\r\n    return chainLink\r\n  }\r\n})\r\n\r\n// create swagger yaml\r\n// run on all routers and describe blocks and assemble swagger.yaml\r\n// mainDescribe -> takes info from app.describe()\r\n// pathDescribe -> takes info from path.describe()\r\nconst CreateSwagger = ({\r\n  _useHttp,\r\n  _Instance,\r\n  stringify,\r\n  mainDescribe,\r\n  _describe,\r\n  pathDescribe,\r\n  schemas,\r\n  fs\r\n}) => ({\r\n  swagger: (swaggerOptions) => {\r\n    let yaml = ''\r\n    _useHttp.swagger = true\r\n    const { _routersObject, _describe } = _useHttp\r\n    yaml += stringify(mainDescribe(_describe))\r\n    const routersKeys = Object.keys(_routersObject)\r\n    const mainPathsObject = { paths: {} }\r\n    const schemasObject = []\r\n    for (let key of routersKeys) {\r\n      const options = ['get', 'post', 'put', 'del']\r\n      const router = _routersObject[key]\r\n      for (let method of options) {\r\n        const paths = Object.keys(router[method])\r\n        for (let path of paths) {\r\n          const fullPath = router.base + path\r\n          const describe = router[method][path].getObjProps().describe\r\n          const responseObjectsForSchema = describe.incoming.filter(\r\n            (request) => request.in === 'body'\r\n          )\r\n          if (responseObjectsForSchema.length > 0) {\r\n            responseObjectsForSchema.map((response) => {\r\n              const obj = {}\r\n              const name = `${fullPath\r\n                .replace(/\\//g, '')\r\n                .replace(/-/, '')\r\n                .replace(/[:]/g, '')}-body-${method}`\r\n              obj.name = name\r\n              // obj.department = 'requestBodies'\r\n              obj.schema = Object.assign({}, response.schema)\r\n              schemasObject.push(obj)\r\n            })\r\n          }\r\n          describe.outgoing.map((response) => {\r\n            const obj = {}\r\n            const name = `${fullPath\r\n              .replace(/\\//g, '')\r\n              .replace(/-/, '')\r\n              .replace(/[{:}]/g, '')}-${response.status}-${method}`\r\n            obj.name = name\r\n            // obj.department = 'responses'\r\n            obj.schema = Object.assign({}, response.schema)\r\n            schemasObject.push(obj)\r\n          })\r\n\r\n          const fullObj = Object.assign({}, describe, { method, path: fullPath })\r\n          Object.assign(mainPathsObject.paths, pathDescribe(fullObj))\r\n        }\r\n      }\r\n      yaml += stringify(mainPathsObject)\r\n      yaml += stringify(schemas(schemasObject))\r\n      // console.log(yaml)\r\n      // console.log(swaggerOptions)\r\n      if (swaggerOptions && swaggerOptions.absoluteFilePath) {\r\n        fs.writeFileSync(swaggerOptions.absoluteFilePath, yaml, 'utf8')\r\n      }\r\n    }\r\n    return _Instance\r\n  }\r\n})\r\n\r\n// assign creator\r\nconst AssignHandler = ({ name, obj, chainLink, override = false }) => ({\r\n  [name]: (data) => {\r\n    override ? Object.assign(obj, data) : (obj[name] = data)\r\n    // console.log(`DATA AFTER: `, object, name, data)\r\n    return chainLink\r\n  }\r\n})\r\n\r\n// list object properties\r\nconst GetObjProps = (obj) => ({\r\n  getObjProps: () => obj\r\n})\r\n\r\n// create event emmiter 2 instance (supports regexes)\r\nconst EventsCreator = (EventEmitter) => ({\r\n  events: new EventEmitter({ wildcard: true })\r\n})\r\n\r\n// when called, receives an object\r\n// returns new object\r\nconst CreateNewObjOf = ({ name, obj, dependencies = {} }) => ({\r\n  [`create${name}`]: (data) => {\r\n    return Object.assign({}, obj(data, ...dependencies))\r\n  }\r\n})\r\n\r\n// pushes data to array\r\nconst CreateArray = ({ name, arr, chainLink }) => ({\r\n  [name]: (data) => {\r\n    arr.push(data)\r\n    return chainLink\r\n  }\r\n})\r\n\r\n// pushes data to middleware array with default timeout of 5s and throwError set to true if timeout occures\r\nconst CreateObjectArray = ({ name, arr, chainLink }) => ({\r\n  [name]: (fn, timeout = 5000, throwError = true) => {\r\n    arr.push({ fn, timeout, throwError })\r\n    return chainLink\r\n  }\r\n})\r\n\r\nexport {\r\n  AssignHandler,\r\n  CreateArray,\r\n  CreateNewObjOf,\r\n  Method,\r\n  GetObjProps,\r\n  Listen,\r\n  PrettyPrint,\r\n  EventsCreator,\r\n  CreateSwagger,\r\n  CreateObjectArray\r\n}\r\n","// register routers func, returns 3 register routers methods, one for http, one for sockets and last one for graphql\r\nconst RegisterRouters = ({\r\n  _useGraphql,\r\n  _useHttp,\r\n  _injected,\r\n  _useSockets,\r\n  _Instance,\r\n  populateSubAppsUtil,\r\n  populateRoutersUtil,\r\n  populateSocketRoutersUtil\r\n}) => ({\r\n  registerRouters: (...routers) => {\r\n    // populate subApps object with sub apps passed\r\n    const { _middleWares, _routersObject, _subApps } = _useHttp\r\n    populateSubAppsUtil(_middleWares, _routersObject, _subApps)\r\n    // populate globalRoutesObject with routers passed\r\n    populateRoutersUtil(_routersObject, routers)\r\n    return _Instance\r\n  },\r\n  registerSocketRouters: (...routers) => {\r\n    // console.log(routers)\r\n    // TODO: add sub apps socket routers\r\n    const { _socketRoutersObject } = _useSockets\r\n    const { delimiter } = _useSockets\r\n    populateSocketRoutersUtil(_socketRoutersObject, routers, null, delimiter)\r\n    // console.log(_socketRoutersObject)\r\n    return _Instance\r\n  },\r\n  registerGraphQlSchemas: (...schemas) => {\r\n    // if remote endpoints set, do not allow local schemas to be registered\r\n    const { _graphQlRemoteEndpoints } = _useGraphql\r\n    if (_graphQlRemoteEndpoints.length > 0) {\r\n      throw new Error(\r\n        'you may only registerGraphQlSchemas or registerRemoteGraphQlSchemas, not either'\r\n      )\r\n    } else {\r\n      Object.assign(_useGraphql._graphQlSchemas, { schemas })\r\n    }\r\n    return _Instance\r\n  },\r\n  registerRemoteGraphQlSchemas: (...endpoints) => {\r\n    // if local endpoints set, do not allow remote schemas to be registered\r\n    if (Object.keys(_useGraphql._graphQlSchemas).length > 0) {\r\n      throw new Error(\r\n        'you may only registerGraphQlSchemas or registerRemoteGraphQlSchemas, not either'\r\n      )\r\n    } else {\r\n      _useGraphql._graphQlRemoteEndpoints = endpoints\r\n      // console.log(endpoints)\r\n    }\r\n    return _Instance\r\n  }\r\n})\r\nexport default RegisterRouters\r\n","// socket handler, called from listen when use sockets is set to true\r\nconst socketHandler = ({\r\n  _useSockets,\r\n  _Instance,\r\n  _injected,\r\n  server,\r\n  _version,\r\n  args,\r\n  os,\r\n  print,\r\n  socketMiddlewareHandler,\r\n  checkSubRouters\r\n}) => {\r\n  const injectedIo = _useSockets.io(server)\r\n  if (args.length > 1) {\r\n    server.listen.apply(server, args)\r\n  } else {\r\n    server.listen.apply(server, [\r\n      args[0],\r\n      () =>\r\n        print([\r\n          `Listening on Bliz server ${_version} on port ${args[0]}`,\r\n          `Platform: ${os.platform()}`,\r\n          `Hostname: ${os.hostname()}`,\r\n          `Architecture: ${os.arch()}`,\r\n          `CPU Cores: ${os.cpus().length}`,\r\n          `Memory Free: ${(\r\n            os.freemem() /\r\n            1024 /\r\n            1024 /\r\n            (os.totalmem() / 1024 / 1024) *\r\n            100\r\n          ).toFixed(0)}%, ${(os.freemem() / 1024 / 1024).toFixed(0)} MB / ${(\r\n            os.totalmem() /\r\n            1024 /\r\n            1024\r\n          ).toFixed(0)} MB`\r\n        ])\r\n    ])\r\n  }\r\n\r\n  // on connection add all routers and middlewares\r\n  injectedIo.on('connection', (socket) => {\r\n    const routersKeys = Object.keys(_useSockets._socketRoutersObject)\r\n    for (let key of routersKeys) {\r\n      const eventKeys = Object.keys(_useSockets._socketRoutersObject[key].event)\r\n      for (let eventKey of eventKeys) {\r\n        socket.on(`${key}${_useSockets.delimiter}${eventKey}`, async (msg, cb) => {\r\n          try {\r\n            const chosenEvent = _useSockets._socketRoutersObject[key].event[eventKey].getObjProps()\r\n            if (_useSockets._socketMiddlewares && _useSockets._socketMiddlewares.length > 0) {\r\n              await socketMiddlewareHandler(\r\n                Promise,\r\n                injectedIo,\r\n                socket,\r\n                msg,\r\n                cb,\r\n                _useSockets._socketMiddlewares\r\n              )\r\n            }\r\n            let combinedMiddlewareArray = []\r\n            key\r\n              .split(_useSockets.delimiter)\r\n              .map(\r\n                (prefix) =>\r\n                  _useSockets._socketRoutersObject[prefix]\r\n                    ? checkSubRouters(\r\n                        _useSockets._socketRoutersObject[prefix],\r\n                        combinedMiddlewareArray\r\n                      )\r\n                    : void 0\r\n              )\r\n\r\n            combinedMiddlewareArray = combinedMiddlewareArray.reduce((prev, curr) =>\r\n              prev.concat(curr)\r\n            )\r\n            if (combinedMiddlewareArray && combinedMiddlewareArray.length > 0) {\r\n              await socketMiddlewareHandler(\r\n                Promise,\r\n                injectedIo,\r\n                socket,\r\n                msg,\r\n                cb,\r\n                combinedMiddlewareArray\r\n              )\r\n            }\r\n            if (chosenEvent.middleWareArr && chosenEvent.middleWareArr.length > 0) {\r\n              await socketMiddlewareHandler(\r\n                Promise,\r\n                injectedIo,\r\n                socket,\r\n                msg,\r\n                cb,\r\n                chosenEvent.middleWareArr\r\n              )\r\n            }\r\n            await chosenEvent.handler(injectedIo, socket, msg, cb, _injected)\r\n          } catch (e) {\r\n            console.log(e)\r\n          }\r\n        })\r\n      }\r\n    }\r\n    socket.on('disconnect', () => {})\r\n  })\r\n  _Instance.events.emit('log')\r\n  return injectedIo\r\n}\r\n\r\nexport default socketHandler\r\n","import { CreateObjectArray, AssignHandler, GetObjProps } from '../objectFactories'\r\n\r\n// socket listener creator\r\nconst CreateSocketListener = (path) => {\r\n  const _PathReturn = {}\r\n  const pathData = {\r\n    middleWareArr: [],\r\n    path,\r\n    handler: null,\r\n    errHandler: null\r\n  }\r\n  return Object.assign(\r\n    _PathReturn,\r\n    CreateObjectArray({ name: 'middleware', arr: pathData.middleWareArr, chainLink: _PathReturn }),\r\n    AssignHandler({ name: 'handler', obj: pathData, chainLink: _PathReturn }),\r\n    AssignHandler({ name: 'errHandler', obj: pathData, chainLink: _PathReturn }),\r\n    GetObjProps(pathData)\r\n  )\r\n}\r\n\r\nexport default CreateSocketListener\r\n","import {\r\n  CreateObjectArray,\r\n  CreateArray,\r\n  AssignHandler,\r\n  GetObjProps,\r\n  Method\r\n} from '../objectFactories'\r\n\r\n// socket router creator\r\nconst SocketRouterCreator = (base) => {\r\n  const _RouterReturn = {}\r\n  const routerData = {\r\n    base,\r\n    event: {},\r\n    middleWareArr: [],\r\n    subRouters: [],\r\n    routerErrorHandler: null\r\n  }\r\n  return Object.assign(\r\n    _RouterReturn,\r\n    Method('event', routerData, _RouterReturn),\r\n    AssignHandler({ name: 'routerErrorHandler', obj: routerData, chainLink: _RouterReturn }),\r\n    CreateObjectArray({\r\n      name: 'middleware',\r\n      arr: routerData.middleWareArr,\r\n      chainLink: _RouterReturn\r\n    }),\r\n    CreateArray({ name: 'socketSubRouter', arr: routerData.subRouters, chainLink: _RouterReturn }),\r\n    GetObjProps(routerData)\r\n  )\r\n}\r\n\r\nexport default SocketRouterCreator\r\n","// check url, split by /, return split url and method to lower case\r\nconst urlUtil = (url, methodUpperCase) => {\r\n  const dividedUrl = url.split('/')\r\n  let method = methodUpperCase.toLowerCase()\r\n  if (method === 'delete') method = 'del'\r\n  let splitRest = dividedUrl.slice(1).map((each) => `/${each}`)\r\n  splitRest.unshift('/')\r\n  splitRest = checkBaseUtil(splitRest)\r\n  return {\r\n    method,\r\n    splitRest\r\n  }\r\n}\r\n\r\n// get remote schemas for schema stitching with graphql\r\nconst getIntrospectSchema = ({\r\n  HttpLink,\r\n  SubscriptionClient,\r\n  fetch,\r\n  ws,\r\n  getMainDefinition,\r\n  split,\r\n  introspectSchema,\r\n  makeRemoteExecutableSchema\r\n}) => async (remoteSchema) => {\r\n  const httpLink = new HttpLink({ uri: remoteSchema.url, fetch })\r\n  const wsLink = new SubscriptionClient(\r\n    remoteSchema.ws,\r\n    {\r\n      reconnect: true\r\n    },\r\n    ws\r\n  )\r\n\r\n  const link = split(\r\n    ({ query }) => {\r\n      const { kind, operation } = getMainDefinition(query)\r\n      return kind === 'OperationDefinition' && operation === 'subscription'\r\n    },\r\n    wsLink,\r\n    httpLink\r\n  )\r\n  const schema = await introspectSchema(httpLink)\r\n\r\n  const executableSchema = makeRemoteExecutableSchema({\r\n    schema,\r\n    link\r\n  })\r\n\r\n  return executableSchema\r\n}\r\n\r\n// used by pretty print to populate object with data received\r\nconst populateObjectWithTreeUtil = (entity, options, objectToAddTo, delimiter) => {\r\n  const keysOfEntity = Object.keys(entity)\r\n  for (let key of keysOfEntity) {\r\n    let obj = {}\r\n    for (let option of options) {\r\n      let routeValues = Object.keys(entity[key][option])\r\n      if (routeValues.length > 0) {\r\n        let routeKey = delimiter || option.toUpperCase()\r\n        let value = {}\r\n        for (let route of routeValues) {\r\n          value[route] = ''\r\n          const assignedOption = { [`${[routeKey]}`]: value }\r\n          Object.assign(obj, assignedOption)\r\n          objectToAddTo[key] = obj\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// recurse on routers object and populate obj passed\r\nconst populateSocketRoutersUtil = (obj, routers, parent = null, delimiter) => {\r\n  // console.log(`obj: `, obj, `routers: `, routers, `parent: `, parent)\r\n  const innerRouterObj = {}\r\n  routers.map((router) => {\r\n    let list = router.getObjProps()\r\n    innerRouterObj[parent ? `${parent}${delimiter}${list.base}` : list.base] = list\r\n    // console.log(`inner object`, innerRouterObj)\r\n    if (list.subRouters.length > 0) {\r\n      return populateSocketRoutersUtil(\r\n        obj,\r\n        list.subRouters,\r\n        parent ? (parent += ':' + list.base) : list.base,\r\n        delimiter\r\n      )\r\n    }\r\n  })\r\n  Object.assign(obj, innerRouterObj)\r\n}\r\n\r\n// recurse on routers object and populate obj passed\r\nconst populateRoutersUtil = (obj, routers, parent = null) => {\r\n  // console.log(obj, routers, parent)\r\n  const innerRouterObj = {}\r\n  routers.map((router) => {\r\n    let list = router.getObjProps()\r\n    innerRouterObj[parent ? `${parent}${list.base}`.replace('//', '/') : list.base] = list\r\n    if (list.subRouters.length > 0) {\r\n      return populateRoutersUtil(obj, list.subRouters, parent ? (parent += list.base) : list.base)\r\n    }\r\n  })\r\n  Object.assign(obj, innerRouterObj)\r\n}\r\n\r\n// recurse on sub apps, populate routers and middlewares\r\nconst populateSubAppsUtil = (mds, routes, subApps) => {\r\n  subApps.map((subApp) => {\r\n    const data = subApp.getObjProps()\r\n    const _middlewares = data._middleWares\r\n    const _routersObject = data._routersObject\r\n    Object.assign(routes, _routersObject)\r\n    mds.push(_middlewares)\r\n    const innerSubApps = data._subApps\r\n    if (innerSubApps.length > 0) {\r\n      return populateSubAppsUtil(mds, routes, innerSubApps)\r\n    }\r\n  })\r\n}\r\n\r\n// nested routers handle test\r\nconst populateUrlOptions = (arr) => {\r\n  let startStr = ''\r\n  return arr.map((urlPart) => {\r\n    startStr += urlPart\r\n    startStr = startStr.replace('//', '/')\r\n    return startStr\r\n  })\r\n}\r\n\r\n// run on split url receives and check each part of the url, if it is defined\r\nconst handleNestedRoutersUtil = (splitUrl, routesObject, combinedRoutersMids = []) => {\r\n  let baseOfRequest\r\n  let rest = null\r\n  let lastDefinedRoute = null\r\n  // check each url in routes obj\r\n  for (let url of splitUrl) {\r\n    // if exists, get middleware\r\n    if (routesObject[url]) {\r\n      lastDefinedRoute = url\r\n      combinedRoutersMids.push(routesObject[url].middleWareArr)\r\n    }\r\n  }\r\n  const indexOfLastRoute = splitUrl.indexOf(lastDefinedRoute)\r\n  baseOfRequest = lastDefinedRoute\r\n  if (baseOfRequest) {\r\n    if (indexOfLastRoute === splitUrl.length - 1) {\r\n      rest = '/'\r\n    } else {\r\n      rest = splitUrl[splitUrl.length - 1]\r\n      rest = rest.substr(baseOfRequest.length)\r\n    }\r\n    if (baseOfRequest === '/') {\r\n      rest = `/${rest}`\r\n    }\r\n    rest = rest.replace('//', '/')\r\n  } else {\r\n    baseOfRequest = '/'\r\n    rest = '/'\r\n  }\r\n  // console.log(`BASE:${baseOfRequest},REST:${rest},LASTURI:${lastDefinedRoute}`)\r\n  // console.log(rest)\r\n  combinedRoutersMids = combinedRoutersMids.reduce((prev, curr) => prev.concat(curr), [])\r\n  return {\r\n    baseOfRequest,\r\n    rest,\r\n    combinedRoutersMids\r\n  }\r\n}\r\n\r\n// populate req.query from url\r\nconst populateQueryUtil = (req, urlArray) => {\r\n  if (urlArray.includes('?')) {\r\n    urlArray\r\n      .substring(urlArray.indexOf('?') + 1)\r\n      .split('&')\r\n      .map((query) => {\r\n        const keyValue = query.split('=')\r\n        req.query[keyValue[0]] = keyValue[1]\r\n      })\r\n    let urlToReturn = urlArray.substring(0, urlArray.indexOf('?'))\r\n    return checkBaseUtil(urlToReturn)\r\n  }\r\n}\r\n\r\n// if //, slice /\r\nconst checkBaseUtil = (base) => {\r\n  let newBase\r\n  if (base[base.length - 1] === '/' && base.length > 1) {\r\n    newBase = base.slice(0, base.length - 1)\r\n  } else {\r\n    newBase = base\r\n  }\r\n  return newBase\r\n}\r\n\r\nconst checkSubRouters = (router, array = []) => {\r\n  router = router.getObjProps ? router.getObjProps() : router\r\n  if (router.middleWareArr.length > 0) {\r\n    array.push(router.middleWareArr)\r\n  }\r\n  if (router.subRouters.length > 0) {\r\n    return router.subRouters.map((router) => checkSubRouters(router, array))\r\n  }\r\n}\r\n\r\n// populate params util and replace params to match original route\r\nconst populateParamsUtil = (req, routersObject, base, method, rest) => {\r\n  try {\r\n    let param\r\n    let canSkipBecauseParams = false\r\n    if (rest === '/') {\r\n      return { canSkipBecauseParams, param }\r\n    } else {\r\n      let arr = Object.keys(routersObject[base][method])\r\n      for (let path of arr) {\r\n        let splitArr = path.split('/')\r\n        let splitUrl = checkBaseUtil(rest).split('/')\r\n        if (splitArr.length === splitUrl.length) {\r\n          let counter = splitArr.length\r\n          let toBeCounted = 0\r\n          for (let i = 0, len = splitArr.length; i < len; i++) {\r\n            if (splitArr[i].includes(':')) {\r\n              toBeCounted += 1\r\n            } else if (splitArr[i] === splitUrl[i]) {\r\n              toBeCounted += 1\r\n            }\r\n          }\r\n          if (toBeCounted === counter) {\r\n            for (let i = 0, len = splitArr.length; i < len; i++) {\r\n              if (splitArr[i].includes(':')) {\r\n                req.params[splitArr[i].replace(':', '')] = splitUrl[i]\r\n                canSkipBecauseParams = true\r\n              }\r\n            }\r\n            param = path\r\n          }\r\n        }\r\n      }\r\n      return {\r\n        param,\r\n        canSkipBecauseParams\r\n      }\r\n    }\r\n  } catch (e) {\r\n    return {\r\n      param: null,\r\n      canSkipBecauseParams: false\r\n    }\r\n  }\r\n}\r\n\r\n// assign nested object properties util\r\nconst assign = (obj, keyPath, value) => {\r\n  let lastKeyIndex = keyPath.length - 1\r\n  for (let i = 0; i < lastKeyIndex; ++i) {\r\n    let key = keyPath[i]\r\n    if (!(key in obj)) obj[key] = {}\r\n    obj = obj[key]\r\n  }\r\n  obj[keyPath[lastKeyIndex]] = value\r\n}\r\n\r\nexport {\r\n  urlUtil,\r\n  populateRoutersUtil,\r\n  populateUrlOptions,\r\n  handleNestedRoutersUtil,\r\n  populateSubAppsUtil,\r\n  checkBaseUtil,\r\n  populateObjectWithTreeUtil,\r\n  populateQueryUtil,\r\n  populateParamsUtil,\r\n  populateSocketRoutersUtil,\r\n  checkSubRouters,\r\n  getIntrospectSchema,\r\n  assign\r\n}\r\n","module.exports = require(\"apollo-cache-control\");","module.exports = require(\"apollo-client-preset\");","module.exports = require(\"apollo-link-http\");","module.exports = require(\"apollo-server-module-graphiql\");","module.exports = require(\"apollo-tracing\");","module.exports = require(\"apollo-utilities\");","module.exports = require(\"babel-polyfill\");","module.exports = require(\"bluebird\");","module.exports = require(\"body-parser\");","module.exports = require(\"etag\");","module.exports = require(\"eventemitter2\");","module.exports = require(\"fs\");","module.exports = require(\"graphql\");","module.exports = require(\"graphql-extensions\");","module.exports = require(\"graphql-subscriptions\");","module.exports = require(\"graphql-tools\");","module.exports = require(\"http\");","module.exports = require(\"json-to-pretty-yaml\");","module.exports = require(\"node-fetch\");","module.exports = require(\"os\");","module.exports = require(\"print-message\");","module.exports = require(\"socket.io\");","module.exports = require(\"subscriptions-transport-ws\");","module.exports = require(\"superstruct\");","module.exports = require(\"treeify\");","module.exports = require(\"url\");","module.exports = require(\"ws\");"],"sourceRoot":""}